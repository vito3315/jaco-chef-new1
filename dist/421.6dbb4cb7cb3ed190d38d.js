"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[421],{5421:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I}),n(2885);var a=n(5861),r=n(5671),l=n(3144),i=n(7326),c=n(136),s=n(6215),o=n(1120),u=n(4942),m=n(4687),h=n.n(m),d=n(7294),p=n(30),f=n(1822),Z=n(3150),v=n(6140),E=n(3030),_=n(8561),g=n(8736),y=n(8727),w=n(808),k=n(231),x=n(1647),b=n(3508),D=n(3892),P=n(5705),S=n(6406);var R=n(7563);function j(e){var t=new Date(e),n=""+(t.getMonth()+1),a=""+t.getDate(),r=t.getFullYear();return n.length<2&&(n="0"+n),a.length<2&&(a="0"+a),[r,n,a].join("-")}var C=function(e){(0,c.Z)(B,e);var t,n,m,C,I,T,O=(I=B,T=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,o.Z)(I);if(T){var n=(0,o.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,s.Z)(this,e)});function B(e){var t;return(0,r.Z)(this,B),t=O.call(this,e),(0,u.Z)((0,i.Z)(t),"click",!1),(0,u.Z)((0,i.Z)(t),"getData",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:R.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e)}))})),t.state={module:"ras_bill_and_cook",module_name:"",is_load:!1,points:[],point:0,rev_list:[],rev:0,cats:[],date_end:j(new Date)},t}return(0,l.Z)(B,[{key:"componentDidMount",value:(C=(0,a.Z)(h().mark((function e(){var t,n=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_all");case 2:t=e.sent,this.setState({points:t.points,point:t.points[0].id,module_name:t.module_info.name}),document.title=t.module_info.name,setTimeout((function(){n.changePoint({target:{value:t.points[0].id}})}),300);case 6:case"end":return e.stop()}}),e,this)}))),function(){return C.apply(this,arguments)})},{key:"updateData",value:(m=(0,a.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={point_id:this.state.point,date_start:this.state.rev,date_end:this.state.date_end},e.next=3,this.getData("show",t);case 3:n=e.sent,console.log(n),this.setState({cats:n.cats});case 6:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"changePoint",value:(n=(0,a.Z)(h().mark((function e(t){var n,a,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.value,a={point_id:n},e.next=4,this.getData("get_rev_list",a);case 4:r=e.sent,this.setState({point:n,rev_list:r,rev:r[0].id});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"changeRev",value:(t=(0,a.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.value,this.setState({rev:n});case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"changeDate",value:function(e){this.setState({date_end:j(e)})}},{key:"render",value:function(){return d.createElement(d.Fragment,null,d.createElement(D.Z,{style:{zIndex:99},open:this.state.is_load},d.createElement(P.Z,{color:"inherit"})),d.createElement(p.ZP,{container:!0,spacing:3},d.createElement(p.ZP,{item:!0,xs:12,sm:12},d.createElement("h1",null,this.state.module_name)),d.createElement(p.ZP,{item:!0,xs:12,sm:4},d.createElement(S.$S,{data:this.state.points,value:this.state.point,func:this.changePoint.bind(this),label:"Точка"})),d.createElement(p.ZP,{item:!0,xs:12,sm:4},d.createElement(S.$S,{data:this.state.rev_list,value:this.state.rev,func:this.changeRev.bind(this),label:"Ревизия"})),d.createElement(p.ZP,{item:!0,xs:12,sm:4},d.createElement(S.Qe,{label:"Дата до",value:this.state.date_end,func:this.changeDate.bind(this)})),d.createElement(p.ZP,{item:!0,xs:12,sm:6},d.createElement(f.Z,{variant:"contained",onClick:this.updateData.bind(this)},"Обновить данные")),d.createElement(p.ZP,{item:!0,xs:12},this.state.cats.map((function(e,t){return d.createElement(y.Z,{key:t},d.createElement(w.Z,{expandIcon:d.createElement(b.Z,null)},d.createElement(x.Z,null,e.name)),d.createElement(k.Z,null,e.cats.map((function(e,t){return d.createElement(y.Z,{key:t},d.createElement(w.Z,{expandIcon:d.createElement(b.Z,null)},d.createElement(x.Z,null,e.name)),d.createElement(k.Z,null,d.createElement(Z.Z,null,d.createElement(_.Z,null,d.createElement(g.Z,null,d.createElement(E.Z,{style:{width:"5%"}},"#"),d.createElement(E.Z,{style:{width:"20%"}},"Товар"),d.createElement(E.Z,{style:{width:"20%"}},"Ревизия"),d.createElement(E.Z,{style:{width:"15%"}},"Кол-во по накладным"),d.createElement(E.Z,{style:{width:"15%"}},"Кол-во по продажам"),d.createElement(E.Z,{style:{width:"15%"}},"Разница"),d.createElement(E.Z,{style:{width:"10%"}},"Ед. измер"))),d.createElement(v.Z,null,e.items.map((function(e,t){return d.createElement(g.Z,{key:t},d.createElement(E.Z,null,t+1),d.createElement(E.Z,null,e.name),d.createElement(E.Z,null,e.count_rev),d.createElement(E.Z,null,e.count_bill),d.createElement(E.Z,null,e.count_ras),d.createElement(E.Z,null,e.count_res),d.createElement(E.Z,null,e.ei_name))}))))))}))))})))))}}]),B}(d.Component);function I(){return d.createElement(C,null)}},2885:(e,t,n)=>{var a=n(4783)(e.id,{locals:!1});e.hot.dispose(a),e.hot.accept(void 0,a)}}]);
//# sourceMappingURL=421.6dbb4cb7cb3ed190d38d.js.map