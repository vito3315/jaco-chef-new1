"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[546],{9546:(e,t,a)=>{a.r(t),a.d(t,{default:()=>P}),a(4010);var n=a(5861),i=a(5671),o=a(3144),s=a(7326),l=a(136),r=a(6215),c=a(1120),u=a(4942),d=a(4687),h=a.n(d),m=a(7294),p=a(7109),f=a(5116),g=a(5725),v=a(2642),y=a(4436),x=a(5272),S=a(5162),w=a(4666),E=a(8979),Z=a(7750),k=a(6408),b=a(7645),T=a(4567),_=a(9062);var C=a(7563),D=function(e){(0,l.Z)(B,e);var t,a,d,D,P=(d=B,D=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(d);if(D){var a=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return(0,r.Z)(this,e)});function B(e){var t;return(0,i.Z)(this,B),t=P.call(this,e),(0,u.Z)((0,s.Z)(t),"getData",(function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:C.stringify({method:e,module:t.state.module,version:2,login:"+79879340391",data:JSON.stringify(a)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e)}))})),t.state={module:"auth",module_name:"",is_load:!1,modalDialog:!1,dialogTitle:"",dialogText:"",activeStep:0,steps:["Телефон","Подтверждение","Новый пароль"],phone:"",code:"",pwd:""},t}return(0,o.Z)(B,[{key:"updateData",value:(a=(0,n.Z)(h().mark((function e(){var t,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={point_id:this.state.point,showReady:!0===this.state.showReady?1:0},e.next=3,this.getData("get_orders",t);case 3:a=e.sent,this.setState({read:a.read,onstol:a.onstol,ordersQueue:a.prestol_new});case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"nextStep",value:(t=(0,n.Z)(h().mark((function e(){var t,a,n,i,o,s,l=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.activeStep){e.next=8;break}return t={login:document.getElementById("phone").value},e.next=4,this.getData("check_phone",t);case 4:!1===(a=e.sent).st?setTimeout((function(){l.setState({modalDialog:!0,dialogTitle:"Предупреждение",dialogText:a.text})}),500):this.setState({activeStep:this.state.activeStep+1,phone:t.login}),e.next=22;break;case 8:if(1!=this.state.activeStep){e.next=16;break}return n={login:this.state.phone,code:document.getElementById("code").value},e.next=12,this.getData("check_code",n);case 12:!1===(i=e.sent).st?setTimeout((function(){l.setState({modalDialog:!0,dialogTitle:"Предупреждение",dialogText:i.text})}),500):this.setState({activeStep:this.state.activeStep+1,code:n.code}),e.next=22;break;case 16:if(2!=this.state.activeStep){e.next=22;break}return o={login:this.state.phone,code:this.state.code,pwd:document.getElementById("password").value},e.next=20,this.getData("save_new_pwd",o);case 20:!1===(s=e.sent).st?setTimeout((function(){l.setState({modalDialog:!0,dialogTitle:"Предупреждение",dialogText:s.text})}),500):(localStorage.setItem("token",s.token),setTimeout((function(){window.location.pathname="/"}),300));case 22:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"enterNextStep",value:function(e){13==e.charCode&&this.nextStep()}},{key:"checkPhone",value:function(e){var t,a=event.target.value;t="+"==(a=a.replace(/[^\d+]/gi,"")).substring(0,1)?12:11,a=a.substring(0,t),document.getElementById("phone").value=a}},{key:"render",value:function(){var e=this;return m.createElement(m.Fragment,null,m.createElement(T.Z,{style:{zIndex:99},open:this.state.is_load},m.createElement(_.Z,{color:"inherit"})),m.createElement(w.Z,{open:this.state.modalDialog,onClose:function(){e.setState({modalDialog:!1})},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},m.createElement(b.Z,{id:"alert-dialog-title"},this.state.dialogTitle),m.createElement(Z.Z,null,m.createElement(k.Z,{id:"alert-dialog-description"},this.state.dialogText)),m.createElement(E.Z,null,m.createElement(v.Z,{onClick:function(){e.setState({modalDialog:!1})},color:"primary",autoFocus:!0},"Хорошо"))),m.createElement(g.ZP,{container:!0,spacing:3,direction:"row",justifyContent:"center",alignItems:"center"},m.createElement(g.ZP,{item:!0,xs:12,sm:6,md:6,lg:4,xl:3},m.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},m.createElement(p.Z,{style:{borderRadius:0,width:"100%",height:150,margin:0,backgroundColor:"#fff",marginBottom:20}},m.createElement("img",{alt:"Жако доставка роллов и пиццы",src:"../assets/img_other/Favikon.png",style:{height:"100%"}})),m.createElement(y.Z,{activeStep:this.state.activeStep,alternativeLabel:!0,style:{width:"100%"}},this.state.steps.map((function(e){return m.createElement(x.Z,{key:e},m.createElement(S.Z,null,e))}))),m.createElement("div",{style:{width:"100%"}},0==this.state.activeStep?m.createElement(f.Z,{variant:"outlined",margin:"normal",size:"small",required:!0,fullWidth:!0,id:"phone",label:"Номер телефона",name:"phone",autoComplete:"phone",autoFocus:!0,onKeyPress:this.enterNextStep.bind(this),onChange:this.checkPhone.bind(this)}):null,1==this.state.activeStep?m.createElement(f.Z,{variant:"outlined",margin:"normal",size:"small",required:!0,fullWidth:!0,id:"code",label:"Код из смс",name:"code",autoComplete:"code",autoFocus:!0,onKeyPress:this.enterNextStep.bind(this)}):null,2==this.state.activeStep?m.createElement(f.Z,{variant:"outlined",margin:"normal",size:"small",required:!0,fullWidth:!0,name:"password",label:"Пароль",type:"password",id:"password",autoComplete:"current-password",onKeyPress:this.enterNextStep.bind(this)}):null,m.createElement(v.Z,{fullWidth:!0,variant:"contained",color:"primary",style:{marginTop:10,marginBottom:10},onClick:this.nextStep.bind(this)},"Дальше"),m.createElement(g.ZP,{container:!0},m.createElement(g.ZP,{item:!0,xs:!0},m.createElement("a",{href:"/auth",style:{color:"#c03"}},"Вернуться к авторизации"))))))))}}]),B}(m.Component);function P(){return m.createElement(D,null)}},4010:(e,t,a)=>{var n=a(4783)(e.id,{locals:!1});e.hot.dispose(n),e.hot.accept(void 0,n)}}]);
//# sourceMappingURL=546.bd4908db2e7261222424.js.map