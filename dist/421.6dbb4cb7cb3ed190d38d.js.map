{"version":3,"file":"421.6dbb4cb7cb3ed190d38d.js","mappings":"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","sources":["webpack://package.json/./src/components/ras_bill_and_cook/ras_bill_and_cook.component.jsx","webpack://package.json/./src/components/ras_bill_and_cook/ras_bill_and_cook.style.scss"],"sourcesContent":["import React from 'react';\r\n\r\nimport Grid from '@mui/material/Grid';\r\nimport Button from '@mui/material/Button';\r\n\r\nimport Table from '@mui/material/Table';\r\nimport TableBody from '@mui/material/TableBody';\r\nimport TableCell from '@mui/material/TableCell';\r\nimport TableHead from '@mui/material/TableHead';\r\nimport TableRow from '@mui/material/TableRow';\r\n\r\nimport Accordion from '@mui/material/Accordion';\r\nimport AccordionSummary from '@mui/material/AccordionSummary';\r\nimport AccordionDetails from '@mui/material/AccordionDetails';\r\nimport Typography from '@mui/material/Typography';\r\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\r\n\r\nimport Backdrop from '@mui/material/Backdrop';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\n\r\nimport { MySelect, MyDatePickerNew } from '../../stores/elements';\r\n\r\nconst queryString = require('query-string');\r\n\r\nfunction formatDate(date) {\r\n  var d = new Date(date),\r\n      month = '' + (d.getMonth() + 1),\r\n      day = '' + d.getDate(),\r\n      year = d.getFullYear();\r\n\r\n  if (month.length < 2) \r\n      month = '0' + month;\r\n  if (day.length < 2) \r\n      day = '0' + day;\r\n\r\n  return [year, month, day].join('-');\r\n}\r\n\r\nclass RasBillAndCook_ extends React.Component {\r\n  click = false;\r\n\r\n  constructor(props) {\r\n    super(props);\r\n        \r\n    this.state = {\r\n      module: 'ras_bill_and_cook',\r\n      module_name: '',\r\n      is_load: false,\r\n      \r\n      points: [],\r\n      point: 0,\r\n      \r\n      rev_list: [],\r\n      rev: 0,\r\n      cats: [],\r\n      \r\n      date_end: formatDate(new Date())\r\n    };\r\n  }\r\n  \r\n  async componentDidMount(){\r\n    let data = await this.getData('get_all');\r\n    \r\n    this.setState({\r\n      points: data.points,\r\n      point: data.points[0].id,\r\n      module_name: data.module_info.name,\r\n    })\r\n    \r\n    document.title = data.module_info.name;\r\n    \r\n    setTimeout( () => {\r\n      this.changePoint({ target: { value: data.points[0].id } });\r\n    }, 300 )\r\n  }\r\n  \r\n  getData = (method, data = {}) => {\r\n    \r\n    this.setState({\r\n      is_load: true\r\n    })\r\n    \r\n    return fetch('https://jacochef.ru/api/index_new.php', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type':'application/x-www-form-urlencoded'},\r\n      body: queryString.stringify({\r\n        method: method, \r\n        module: this.state.module,\r\n        version: 2,\r\n        login: localStorage.getItem('token'),\r\n        data: JSON.stringify( data )\r\n      })\r\n    }).then(res => res.json()).then(json => {\r\n      \r\n      if( json.st === false && json.type == 'redir' ){\r\n        window.location.pathname = '/';\r\n        return;\r\n      }\r\n      \r\n      if( json.st === false && json.type == 'auth' ){\r\n        window.location.pathname = '/auth';\r\n        return;\r\n      }\r\n      \r\n      setTimeout( () => {\r\n        this.setState({\r\n          is_load: false\r\n        })\r\n      }, 300 )\r\n      \r\n      return json;\r\n    })\r\n    .catch(err => { \r\n      console.log( err )\r\n    });\r\n  }\r\n   \r\n  async updateData(){\r\n    let data = {\r\n      point_id: this.state.point,\r\n      date_start: this.state.rev,\r\n      date_end: this.state.date_end,\r\n    };\r\n    \r\n    let res = await this.getData('show', data);\r\n    \r\n    console.log( res )\r\n    \r\n    this.setState({\r\n      cats: res.cats\r\n    })\r\n  }\r\n  \r\n  async changePoint(event){\r\n    let point = event.target.value;\r\n    \r\n    let data = {\r\n      point_id: point\r\n    };\r\n    \r\n    let res = await this.getData('get_rev_list', data);\r\n\r\n    this.setState({\r\n      point: point,\r\n      rev_list: res,\r\n      rev: res[0].id\r\n    })\r\n  }\r\n\r\n  async changeRev(event){\r\n    let rev = event.target.value;\r\n    \r\n    this.setState({\r\n      rev: rev\r\n    })\r\n  }\r\n\r\n  changeDate(data){\r\n    this.setState({\r\n      date_end: formatDate(data)\r\n    })\r\n  }\r\n\r\n  render(){\r\n    return (\r\n      <>\r\n        <Backdrop style={{ zIndex: 99 }} open={this.state.is_load}>\r\n          <CircularProgress color=\"inherit\" />\r\n        </Backdrop>\r\n        \r\n        <Grid container spacing={3}>\r\n          <Grid item xs={12} sm={12}>\r\n            <h1>{this.state.module_name}</h1>\r\n          </Grid>\r\n          \r\n          <Grid item xs={12} sm={4}>\r\n            <MySelect data={this.state.points} value={this.state.point} func={ this.changePoint.bind(this) } label='Точка' />\r\n          </Grid>\r\n\r\n          <Grid item xs={12} sm={4}>\r\n            <MySelect data={this.state.rev_list} value={this.state.rev} func={ this.changeRev.bind(this) } label='Ревизия' />\r\n          </Grid>\r\n\r\n          <Grid item xs={12} sm={4}>\r\n            <MyDatePickerNew label='Дата до' value={this.state.date_end} func={ this.changeDate.bind(this) } />\r\n          </Grid>\r\n\r\n          <Grid item xs={12} sm={6}>\r\n            <Button variant=\"contained\" onClick={this.updateData.bind(this)}>Обновить данные</Button>\r\n          </Grid>\r\n        \r\n          <Grid item xs={12}>\r\n            \r\n            { this.state.cats.map( (item, key) =>\r\n              <Accordion key={key}>\r\n                <AccordionSummary\r\n                  expandIcon={<ExpandMoreIcon />}\r\n                >\r\n                  <Typography>{item.name}</Typography>\r\n                </AccordionSummary>\r\n                <AccordionDetails>\r\n                  { item.cats.map( (cat, key_cat) => \r\n                    <Accordion key={key_cat}>\r\n                      <AccordionSummary\r\n                        expandIcon={<ExpandMoreIcon />}\r\n                      >\r\n                        <Typography>{cat.name}</Typography>\r\n                      </AccordionSummary>\r\n                      <AccordionDetails>\r\n                        \r\n                        <Table>\r\n                  \r\n                          <TableHead>\r\n                            <TableRow>\r\n                              <TableCell style={{ width: '5%' }}>#</TableCell>\r\n\r\n                              <TableCell style={{ width: '20%' }}>Товар</TableCell>\r\n                              <TableCell style={{ width: '20%' }}>Ревизия</TableCell>\r\n\r\n                              <TableCell style={{ width: '15%' }}>Кол-во по накладным</TableCell>\r\n                              <TableCell style={{ width: '15%' }}>Кол-во по продажам</TableCell>\r\n\r\n                              <TableCell style={{ width: '15%' }}>Разница</TableCell>\r\n                              <TableCell style={{ width: '10%' }}>Ед. измер</TableCell>\r\n                            </TableRow>\r\n                          </TableHead>\r\n\r\n                          <TableBody>\r\n                            \r\n                            { cat.items.map( (it, k) =>\r\n                              <TableRow key={k}>\r\n                                <TableCell>{k+1}</TableCell>\r\n                                <TableCell>{it.name}</TableCell>\r\n                                <TableCell>{it.count_rev}</TableCell>\r\n                                <TableCell>{it.count_bill}</TableCell>\r\n                                <TableCell>{it.count_ras}</TableCell>\r\n                                <TableCell>{it.count_res}</TableCell>\r\n                                <TableCell>{it.ei_name}</TableCell>\r\n                              </TableRow>\r\n                            ) }\r\n                          \r\n                          </TableBody>\r\n                        \r\n                        </Table>\r\n\r\n                      </AccordionDetails>\r\n                    </Accordion>\r\n                  ) }\r\n                </AccordionDetails>\r\n              </Accordion>\r\n            ) }\r\n            \r\n\r\n          </Grid>\r\n        </Grid>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport function RasBillAndCook() {\r\n  return (\r\n    <RasBillAndCook_ />\r\n  );\r\n}","// extracted by mini-css-extract-plugin\nexport {};\n    if(module.hot) {\n      // 1668348145136\n      var cssReload = require(\"../../../node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"names":["queryString","require","formatDate","date","d","Date","month","getMonth","day","getDate","year","getFullYear","length","join","RasBillAndCook_","props","method","data","setState","is_load","fetch","headers","body","stringify","module","state","version","login","localStorage","getItem","JSON","then","res","json","st","type","setTimeout","window","location","pathname","err","console","log","module_name","points","point","rev_list","rev","cats","date_end","this","getData","id","module_info","name","document","title","changePoint","target","value","point_id","date_start","event","Backdrop","style","zIndex","open","CircularProgress","color","Grid","container","spacing","item","xs","sm","func","bind","label","changeRev","changeDate","Button","variant","onClick","updateData","map","key","Accordion","AccordionSummary","expandIcon","ExpandMore","Typography","AccordionDetails","cat","key_cat","Table","TableHead","TableRow","TableCell","width","TableBody","items","it","k","count_rev","count_bill","count_ras","count_res","ei_name","React","RasBillAndCook","cssReload","hot","dispose","accept","undefined"],"sourceRoot":""}