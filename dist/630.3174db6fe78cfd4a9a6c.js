"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[630],{630:(e,t,i)=>{i.r(t),i.d(t,{default:()=>$}),i(5673);var n=i(5861),a=i(7326),s=i(4942),m=i(5671),l=i(3144),r=i(136),c=i(6215),o=i(1120),d=i(4687),u=i.n(d),h=i(7294),p=i(30),E=i(1822),w=i(3892),f=i(5705),_=i(9620),v=i(2962),Z=i(4498),g=i(7745),y=i(3150),k=i(6140),b=i(3030),N=i(8561),x=i(8736),I=i(8573),P=i(1388),S=i(1702),C=i(594),T=i(2961),D=i(6406);function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var i,n=(0,o.Z)(e);if(t){var a=(0,o.Z)(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return(0,c.Z)(this,i)}}var W=i(7563),R=function(e){(0,r.Z)(i,e);var t=B(i);function i(){return(0,m.Z)(this,i),t.apply(this,arguments)}return(0,l.Z)(i,[{key:"shouldComponentUpdate",value:function(e){var t=e.items,i=this.props.items;return!(t.length==i.length&&t.every((function(e,t){return e===i[t]})))}},{key:"render",value:function(){var e=this;return h.createElement(y.Z,null,h.createElement(N.Z,null,h.createElement(x.Z,null,h.createElement(b.Z,null,"Работа"),h.createElement(b.Z,null,"Должность"),h.createElement(b.Z,null,"Время"),h.createElement(b.Z,null,"День недели"),h.createElement(b.Z,null,"Время открытия"),h.createElement(b.Z,null,"Время автоматического удаления"),h.createElement(b.Z,null,"Не удалять в конце смены"),h.createElement(b.Z,null,"Обязательна к выполнению в особый день"),h.createElement(b.Z,null,h.createElement(T.Z,null)))),h.createElement(k.Z,null,this.props.items.map((function(t,i){return h.createElement(x.Z,{key:i},h.createElement(b.Z,{onClick:e.props.openWork.bind(e,t.id),style:{color:"#c03",cursor:"pointer",fontWeight:"bold"}},t.work_name),h.createElement(b.Z,null,t.app_name),h.createElement(b.Z,null,t.time_min?t.time_min+"мин.":""),h.createElement(b.Z,null,t.dow_name),h.createElement(b.Z,null,t.times_open),h.createElement(b.Z,null,t.times_close),h.createElement(b.Z,null,h.createElement(D.IA,{value:1==parseInt(t.is_not_del),func:e.props.changeCheck.bind(e,i,"is_not_del"),label:""})),h.createElement(b.Z,null,h.createElement(D.IA,{value:1==parseInt(t.is_need),func:e.props.changeCheck.bind(e,i,"is_need"),label:""})),h.createElement(b.Z,null,h.createElement(D.IA,{value:1==parseInt(t.is_active),func:e.props.changeCheck.bind(e,i,"is_active"),label:""})))}))))}}]),i}(h.Component),j=function(e){(0,r.Z)(b,e);var t,i,c,o,d,y,k=B(b);function b(e){var t;return(0,m.Z)(this,b),t=k.call(this,e),(0,s.Z)((0,a.Z)(t),"getData",(function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:W.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(i)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e),t.setState({is_load:!1})}))})),t.state={module:"app_work",module_name:"",is_load:!1,items:[],items_min:[],modalDialog:!1,modalDialogNew:!1,dows:[{id:1,name:"Понедельник"},{id:2,name:"Вторник"},{id:3,name:"Среда"},{id:4,name:"Четверг"},{id:5,name:"Пятница"},{id:6,name:"Суббота"},{id:7,name:"Воскресенье"},{id:10,name:"Другое"},{id:11,name:"Каждый день"},{id:12,name:"Каждый день в конце смены"},{id:13,name:"Ручное добавление"},{id:14,name:"После выполнение уборки"}],types:[{id:0,name:"Другое"},{id:1,name:"Только 1 активная"},{id:2,name:"Добавление без ограничений"}],itemsEdit:null,nameWork:"",itemsNew:null,chengeItem1:null,chengeItemNew1:null},t}return(0,l.Z)(b,[{key:"componentDidMount",value:(y=(0,n.Z)(u().mark((function e(){var t,i=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_all");case 2:(t=e.sent).items.map((function(e,n){t.items[n].dow_name=i.state.dows.find((function(t){return parseInt(t.id)==parseInt(e.dow)})).name})),this.setState({module_name:t.module_info.name,items:t.items,items_min:t.items_min}),document.title=t.module_info.name;case 6:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"openCat",value:function(e){this.setState({modalDialog:!0,showCat:e,nameCat:e.name,editText:e.text})}},{key:"saveEdit",value:(d=(0,n.Z)(u().mark((function e(){var t,i,n,a,s=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.state.itemsEdit).item.type_new=this.state.itemsEdit.item.type_new.id,t.item.app_id=this.state.itemsEdit.item.app_id.id,i={work:t.item,times_add:this.state.itemsEdit.times_add,times_close:this.state.itemsEdit.times_close},e.next=6,this.getData("save_edit",i);case 6:if(n=e.sent,console.log(n),!1!==n.st){e.next=12;break}alert(n.text),e.next=18;break;case 12:return this.setState({modalDialog:!1,itemsEdit:null,nameWork:""}),e.next=15,this.getData("get_all");case 15:(a=e.sent).items.map((function(e,t){a.items[t].dow_name=s.state.dows.find((function(t){return parseInt(t.id)==parseInt(e.dow)})).name})),this.setState({items:a.items,items_min:a.items_min});case 18:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"saveNew",value:(o=(0,n.Z)(u().mark((function e(){var t,i,n,a,s=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=this.state.itemsEdit).item.type_new=this.state.itemsNew.item.type_new.id,t.item.app_id=this.state.itemsNew.item.app_id.id,i={work:t.item,times_add:this.state.itemsNew.times_add,times_close:this.state.itemsNew.times_close},e.next=6,this.getData("save_new",i);case 6:if(n=e.sent,console.log(n),!1!==n.st){e.next=12;break}alert(n.text),e.next=18;break;case 12:return this.setState({modalDialogNew:!1,itemsNew:null}),e.next=15,this.getData("get_all");case 15:(a=e.sent).items.map((function(e,t){a.items[t].dow_name=s.state.dows.find((function(t){return parseInt(t.id)==parseInt(e.dow)})).name})),this.setState({items:a.items,items_min:a.items_min});case 18:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"openWork",value:(c=(0,n.Z)(u().mark((function e(t){var i,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={id:t},e.next=3,this.getData("get_one",i);case 3:(n=e.sent).item.type_new=n.cats.find((function(e){return e.id===n.item.type_new})),n.item.app_id=n.apps.find((function(e){return e.id===n.item.app_id})),this.setState({itemsEdit:n,modalDialog:!0,nameWork:n.item.name,chengeItem1:this.state.items_min.find((function(e,t){return parseInt(e.id)==parseInt(n.item.work_id)}))});case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"openNewWork",value:(i=(0,n.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_all_for_new");case 2:t=e.sent,this.setState({itemsNew:t,modalDialogNew:!0});case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"chengeItem",value:function(e,t){var i=t.target.value,n=this.state.itemsEdit;n.item[[e]]=i,"dow"==e&&12==i&&(n.times_add=[{time_action:"19:00"}],n.times_close="23:00"),"dow"==e&&13==i&&(n.times_add=[]),this.setState({itemsEdit:n})}},{key:"chengeItem1",value:function(e,t,i){var n=this.state.itemsEdit;n.item[[e]]=i.id,this.setState({itemsEdit:n,chengeItem1:i})}},{key:"chengeItemNew",value:function(e,t){var i=t.target.value,n=this.state.itemsNew;n.item[[e]]=i,"dow"==e&&12==i&&(n.times_add=[{time_action:"19:00"}],n.times_close="23:00"),"dow"==e&&13==i&&(n.times_add=[]),this.setState({itemsNew:n})}},{key:"chengeItemNew1",value:function(e,t,i){var n=this.state.itemsNew;n.item[[e]]=i.id,this.setState({itemsNew:n,chengeItemNew1:i})}},{key:"chengeTime",value:function(e,t){var i=t.target.value,n=this.state.itemsEdit;n.times_add[e].time_action=i,this.setState({itemsEdit:n})}},{key:"chengeTimeNew",value:function(e,t){var i=t.target.value,n=this.state.itemsNew;n.times_add[e].time_action=i,this.setState({itemsNew:n})}},{key:"delTime",value:function(e){var t=this.state.itemsEdit,i=[];t.times_add.map((function(t,n){parseInt(n)!=parseInt(e)&&i.push(t)})),t.times_add=i,this.setState({itemsEdit:t})}},{key:"delTimeNew",value:function(e){var t=this.state.itemsNew,i=[];t.times_add.map((function(t,n){parseInt(n)!=parseInt(e)&&i.push(t)})),t.times_add=i,this.setState({itemsNew:t})}},{key:"addTime",value:function(e){var t=document.getElementById("timePikerNew").value,i=this.state.itemsEdit;""!=t&&(i.times_add.push({time_action:t}),this.setState({itemsEdit:i}))}},{key:"addTimeNew",value:function(e){var t=document.getElementById("timePikerNew").value,i=this.state.itemsNew;""!=t&&(i.times_add.push({time_action:t}),this.setState({itemsNew:i}))}},{key:"chengeTimeClose",value:function(e){var t=e.target.value,i=this.state.itemsEdit;i.times_close=t,this.setState({itemsEdit:i})}},{key:"chengeTimeCloseNew",value:function(e){var t=e.target.value,i=this.state.itemsNew;i.times_close=t,this.setState({itemsNew:i})}},{key:"changeCheck",value:(t=(0,n.Z)(u().mark((function e(t,i,n){var a,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=this.state.items)[t][[i]]=n.target.checked?1:0,s={type:i,value:n.target.checked?1:0,id:a[t].id},e.next=5,this.getData("save_check",s);case 5:e.sent,this.setState({items:a});case 7:case"end":return e.stop()}}),e,this)}))),function(e,i,n){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return h.createElement(h.Fragment,null,h.createElement(w.Z,{open:this.state.is_load,style:{zIndex:99}},h.createElement(f.Z,{color:"inherit"})),this.state.itemsEdit?h.createElement(_.Z,{open:this.state.modalDialog,maxWidth:"md",onClose:function(){e.setState({modalDialog:!1,itemsEdit:null,nameWork:""})}},h.createElement(g.Z,null,'Уборка "',this.state.nameWork,'"'),h.createElement(Z.Z,{style:{paddingTop:10}},h.createElement(p.ZP,{container:!0,spacing:3},h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.rZ,{value:this.state.itemsEdit.item.name,func:this.chengeItem.bind(this,"name"),label:"Название уборки"})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.e_,{label:"Категория уборки",multiple:!1,data:this.state.itemsEdit.cats,value:0===this.state.itemsEdit.item.type_new?null:this.state.itemsEdit.item.type_new,func:function(t,i){var n=e.state.itemsEdit;n.item.type_new=i,e.setState({itemsEdit:n})}})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.rZ,{value:this.state.itemsEdit.item.time_min,func:this.chengeItem.bind(this,"time_min"),label:"Время уборки (в минутах)"})),h.createElement(p.ZP,{item:!0,xs:12,sm:3},h.createElement(D.rZ,{value:this.state.itemsEdit.item.max_count,func:this.chengeItem.bind(this,"max_count"),label:"Количество активаций"})),h.createElement(p.ZP,{item:!0,xs:12,sm:9},h.createElement(D.rZ,{multiline:!0,maxRows:2,value:this.state.itemsEdit.item.description,func:this.chengeItem.bind(this,"description"),label:"Описание (для внутренного использования)"})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.e_,{label:"Должность",multiple:!1,data:this.state.itemsEdit.apps,value:0===this.state.itemsEdit.item.app_id?null:this.state.itemsEdit.item.app_id,func:function(t,i){var n=e.state.itemsEdit;n.item.app_id=i,e.setState({itemsEdit:n})}})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.$S,{data:this.state.dows,value:this.state.itemsEdit.item.dow,func:this.chengeItem.bind(this,"dow"),label:"День недели"})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.$S,{data:this.state.types,value:this.state.itemsEdit.item.type_time,func:this.chengeItem.bind(this,"type_time"),label:"Тип добавления"})),14!=parseInt(this.state.itemsEdit.item.dow)?null:h.createElement(p.ZP,{item:!0,xs:12},h.createElement(p.ZP,{container:!0,spacing:3},h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(D.e_,{data:this.state.items_min,value:0===this.state.chengeItem1?null:this.state.chengeItem1,func:this.chengeItem1.bind(this,"work_id"),multiple:!1,label:"Если эта уборка завершена"})))),h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(I.Z,null,h.createElement(P.ZP,{style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(S.Z,{primary:"Время добавления уборки"})),this.state.itemsEdit.times_add.map((function(t,i){return h.createElement(P.ZP,{key:i,style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(D.w0,{label:"",value:t.time_action,func:e.chengeTime.bind(e,i)}),h.createElement(C.Z,{style:{cursor:"pointer"},onClick:e.delTime.bind(e,i)}))})),h.createElement(P.ZP,{style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(D.w0,{id:"timePikerNew",label:"",value:"00:00",onBlur:this.addTime.bind(this)})))),h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(I.Z,null,h.createElement(P.ZP,{style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(S.Z,{primary:"Время автоматического удаления"})),h.createElement(P.ZP,{style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(D.w0,{label:"",value:this.state.itemsEdit.times_close,func:this.chengeTimeClose.bind(this)})))))),h.createElement(v.Z,null,h.createElement(E.Z,{color:"primary",onClick:this.saveEdit.bind(this)},"Сохранить"))):null,this.state.itemsNew?h.createElement(_.Z,{open:this.state.modalDialogNew,maxWidth:"md",onClose:function(){e.setState({modalDialogNew:!1})}},h.createElement(g.Z,null,"Новая уборка"),h.createElement(Z.Z,{style:{paddingTop:10}},h.createElement(p.ZP,{container:!0,spacing:3},h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.rZ,{value:this.state.itemsNew.item.name,func:this.chengeItemNew.bind(this,"name"),label:"Название уборки"})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.e_,{label:"Категория уборки",multiple:!1,data:this.state.itemsNew.cats,value:0===this.state.itemsNew.item.type_new?null:this.state.itemsNew.item.type_new,func:function(t,i){var n=e.state.itemsNew;n.item.type_new=i,e.setState({itemsNew:n})}})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.rZ,{value:this.state.itemsNew.item.time_min,func:this.chengeItemNew.bind(this,"time_min"),label:"Время уборки (в минутах)"})),h.createElement(p.ZP,{item:!0,xs:12,sm:3},h.createElement(D.rZ,{value:this.state.itemsNew.item.max_count,func:this.chengeItemNew.bind(this,"max_count"),label:"Количество активаций"})),h.createElement(p.ZP,{item:!0,xs:12,sm:9},h.createElement(D.rZ,{multiline:!0,maxRows:2,value:this.state.itemsNew.item.description,func:this.chengeItemNew.bind(this,"description"),label:"Описание (для внутренного использования)"})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.e_,{label:"Должность",multiple:!1,data:this.state.itemsNew.apps,value:0===this.state.itemsNew.item.app_id?null:this.state.itemsNew.item.app_id,func:function(t,i){var n=e.state.itemsNew;n.item.app_id=i,e.setState({itemsNew:n})}})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.$S,{data:this.state.dows,value:0===this.state.itemsNew.item.dow?"":this.state.itemsNew.item.dow,func:this.chengeItemNew.bind(this,"dow"),label:"День недели"})),h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(D.$S,{data:this.state.types,value:0===this.state.itemsNew.item.type_time?"":this.state.itemsNew.item.type_time,func:this.chengeItemNew.bind(this,"type_time"),label:"Тип добавления"})),14!=parseInt(this.state.itemsNew.item.dow)?null:h.createElement(p.ZP,{item:!0,xs:12},h.createElement(p.ZP,{container:!0,spacing:3},h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(D.e_,{data:this.state.items_min,value:0===this.state.chengeItemNew1?null:this.state.chengeItemNew1,func:this.chengeItemNew1.bind(this,"work_id"),multiple:!1,label:"Если эта уборка завершена"})))),h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(I.Z,null,h.createElement(P.ZP,{style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(S.Z,{primary:"Время добавления уборки"})),this.state.itemsNew.times_add.map((function(t,i){return h.createElement(P.ZP,{key:i,style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(D.w0,{label:"",value:t.time_action,func:e.chengeTimeNew.bind(e,i)}),h.createElement(C.Z,{style:{cursor:"pointer"},onClick:e.delTimeNew.bind(e,i)}))})),h.createElement(P.ZP,{style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(D.w0,{id:"timePikerNew",label:"",value:"00:00",onBlur:this.addTimeNew.bind(this)})))),h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(I.Z,null,h.createElement(P.ZP,{style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(S.Z,{primary:"Время автоматического удаления"})),h.createElement(P.ZP,{style:{borderBottom:"1px solid #e5e5e5"}},h.createElement(D.w0,{label:"",value:this.state.itemsNew.times_close,func:this.chengeTimeCloseNew.bind(this)})))))),h.createElement(v.Z,null,h.createElement(E.Z,{color:"primary",onClick:this.saveNew.bind(this)},"Сохранить"))):null,h.createElement(p.ZP,{container:!0,spacing:3},h.createElement(p.ZP,{item:!0,xs:12,sm:12},h.createElement("h1",null,this.state.module_name)),h.createElement(p.ZP,{item:!0,xs:12,sm:12},h.createElement(E.Z,{variant:"contained",color:"primary",onClick:this.openNewWork.bind(this)},"Добавить уборку")),h.createElement(p.ZP,{item:!0,xs:12,sm:12},this.state.items.length>0?h.createElement(R,{items:this.state.items,openWork:this.openWork.bind(this),changeCheck:this.changeCheck.bind(this)}):null)))}}]),b}(h.Component);function $(){return h.createElement(j,null)}},5673:(e,t,i)=>{var n=i(4783)(e.id,{locals:!1});e.hot.dispose(n),e.hot.accept(void 0,n)}}]);
//# sourceMappingURL=630.3174db6fe78cfd4a9a6c.js.map