{"version":3,"file":"500.e2933c5a7ad6e955d489.js","mappings":"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","sources":["webpack://package.json/./src/components/app_work_point/app_work_point.component.jsx","webpack://package.json/./src/components/app_work_point/app_work_point.style.scss"],"sourcesContent":["import React from 'react';\nimport Grid from '@mui/material/Grid';\nimport Button from '@mui/material/Button';\n\nimport Backdrop from '@mui/material/Backdrop';\nimport CircularProgress from '@mui/material/CircularProgress';\n\nimport List from '@mui/material/List';\nimport ListItem from '@mui/material/ListItem';\nimport ListItemText from '@mui/material/ListItemText';\n\nimport SendIcon from '@mui/icons-material/Send';\nimport CloseIcon from '@mui/icons-material/Close';\n\nimport Table from '@mui/material/Table';\nimport TableBody from '@mui/material/TableBody';\nimport TableCell from '@mui/material/TableCell';\nimport TableHead from '@mui/material/TableHead';\nimport TableRow from '@mui/material/TableRow';\n\nimport { MyTextInput, MySelect } from '../../stores/elements';\n\nconst queryString = require('query-string');\n\nclass AppWorkPoint_ extends React.Component {\n  constructor(props) {\n    super(props);\n        \n    this.state = {\n      module: 'app_work_point',\n      module_name: '',\n      is_load: false,\n      \n      points: [],\n      point_id: 0,\n\n      apps: [],\n      app_id: 0,\n\n      allList: [],\n      allListRender: [],\n      thisList: []\n    };\n  }\n  \n  async componentDidMount(){\n    let data = await this.getData('get_all');\n    \n    this.setState({\n      module_name: data.module_info.name,\n      points: data.points,\n      point_id: data.points[0].id,\n      apps: data.apps,\n      app_id: data.apps[0].id\n    })\n    \n    document.title = data.module_info.name;\n\n    setTimeout( () => {\n      this.getWorks();\n    }, 300 )\n  }\n  \n  getData = (method, data = {}) => {\n    \n    this.setState({\n      is_load: true\n    })\n    \n    return fetch('https://jacochef.ru/api/index_new.php', {\n      method: 'POST',\n      headers: {\n        'Content-Type':'application/x-www-form-urlencoded'},\n      body: queryString.stringify({\n        method: method, \n        module: this.state.module,\n        version: 2,\n        login: localStorage.getItem('token'),\n        data: JSON.stringify( data )\n      })\n    }).then(res => res.json()).then(json => {\n      \n      if( json.st === false && json.type == 'redir' ){\n        window.location.pathname = '/';\n        return;\n      }\n      \n      if( json.st === false && json.type == 'auth' ){\n        window.location.pathname = '/auth';\n        return;\n      }\n      \n      setTimeout( () => {\n        this.setState({\n          is_load: false\n        })\n      }, 300 )\n      \n      return json;\n    })\n    .catch(err => { \n      console.log( err )\n      this.setState({\n        is_load: false\n      })\n    });\n  }\n   \n  changeApp(event){\n    this.setState({\n      app_id: event.target.value\n    });\n\n    setTimeout( () => {\n      this.getWorks();\n    }, 300 )\n  }\n\n  async getWorks(){\n    let data = {\n      point_id: this.state.point_id,\n      app_id: this.state.app_id\n    };\n\n    let res = await this.getData('get_works', data);\n\n    console.log( res )\n\n    this.setState({\n      allList: res.all_work,\n      thisList: res.this_work,\n    })\n\n    setTimeout( () => {\n      this.checkList();\n    }, 300 )\n  }\n\n  checkList(){\n    let allList = this.state.allList;\n    let thisList = this.state.thisList;\n\n    thisList.map( (Titem) => {\n      let newArr = [];\n\n        allList.map( (Aitem) => {\n          if( parseInt(Aitem.id) != parseInt(Titem.id) ){\n            newArr.push(Aitem);\n          }\n        })\n\n        allList = newArr;\n    } )\n\n    this.setState({\n      allListRender: allList\n    })\n  }\n\n  add(id, name){\n    let thisList = this.state.thisList;\n    let allList = this.state.allList;\n\n    let check = thisList.find( (item, key) => parseInt(item['id']) == parseInt(id) );\n    let thisItem = allList.find( (item, key) => parseInt(item['id']) == parseInt(id) );\n\n\t\tif( !check ){\n\t\t\tthisList.push({id: id, name: name, time_min: 0, dop_time: 0, time_min: thisItem.time_min})\n\t\t}\n\n\t\tthis.setState({\n      thisList: thisList\n    })\n\n    setTimeout( () => {\n      this.checkList();\n    }, 300 )\n  }\n\n  del(id, name){\n    let new_arr = [];\n    let thisList = this.state.thisList;\n\n\t\tthisList.map(function(item, key){\n\t\t\tif( parseInt(item['id']) != parseInt(id) ){\n\t\t\t\tnew_arr.push( item )\n\t\t\t}\n\t\t})\n\n\t\tthis.setState({\n      thisList: new_arr\n    })\n\n    setTimeout( () => {\n      this.checkList();\n    }, 300 )\n\t}\n\n  async save(){\n    let data = {\n      point_id: this.state.point_id,\n      app_id: this.state.app_id,\n      items: this.state.thisList\n    };\n\n    let fake_item = null;\n\n    this.state.thisList.map( (item, key) => {\n      if( item.dop_time.length == 0 ){\n        fake_item = item;\n      }\n    } )\n\n    console.log(fake_item  )\n\n    if( fake_item ){\n      alert('У позиции \"'+fake_item.name+'\" не указано доп время');\n\n      return ;\n    }\n\n    let res = await this.getData('save', data);\n\n    console.log( res )\n\n    alert(res.text)\n  }\n\n  changeDopTime(key, event){\n    let data = event.target.value;\n    let list = this.state.thisList;\n\n    if( !isNaN(data) || data == ''  ){\n      list[ key ]['dop_time'] = data == '' ? '' : parseInt(data);\n\n      this.setState({\n        thisList: list\n      })\n    }\n  }\n\n  render(){\n    return (\n      <>\n        <Backdrop style={{ zIndex: 99 }} open={this.state.is_load}>\n          <CircularProgress color=\"inherit\" />\n        </Backdrop>\n        \n        <Grid container spacing={3}>\n          <Grid item xs={12} sm={12}>\n            <h1>{this.state.module_name}</h1>\n          </Grid>\n\n          <Grid item xs={12} sm={3}>\n            <MySelect data={this.state.points} value={this.state.point_id} func={ (event) => { this.setState({ point_id: event.target.value }) } } label='Точка' />\n          </Grid>\n          <Grid item xs={12} sm={3}>\n            <MySelect data={this.state.apps} value={this.state.app_id} func={ this.changeApp.bind(this) } label='Должность' />\n          </Grid>\n\n          <Grid item xs={12} sm={3}>\n            <Button variant=\"contained\" onClick={this.getWorks.bind(this)}>Обновить данные</Button>\n          </Grid>\n\n          <Grid item xs={12} sm={6}>\n            <List style={{ width: '100%' }}>\n              { this.state.allListRender.map( (item, key) =>\n                <ListItem key={key} style={{ borderBottom: '1px solid #e5e5e5' }}>\n                  <ListItemText primary={ item.name } />\n                  <SendIcon onClick={this.add.bind(this, item.id, item.name)} />\n                </ListItem>\n              ) }\n            </List>\n          </Grid>\n\n          <Grid item xs={12} sm={6}>\n            <Table size='small'>\n              <TableHead>\n                <TableRow>\n                  <TableCell>Наименование</TableCell>\n                  <TableCell>Основное время</TableCell>\n                  <TableCell>Доп время (в минутах)</TableCell>\n                  <TableCell><CloseIcon /></TableCell>\n                </TableRow>\n              </TableHead>\n\n              <TableBody>\n                \n                { this.state.thisList.map( (item, key) =>\n                  <TableRow key={key}>\n                    <TableCell>{item.name}</TableCell>\n                    <TableCell>{item.time_min} мин.</TableCell>\n                    <TableCell>\n                      <MyTextInput value={ item.dop_time } func={ this.changeDopTime.bind(this, key) } label='' />\n                    </TableCell>\n                    <TableCell>\n                      <CloseIcon onClick={this.del.bind(this, item.id, item.name)} style={{cursor: 'pointer'}} />\n                    </TableCell>\n                  </TableRow>\n                ) }\n              \n              </TableBody>\n            \n            </Table>\n\n          </Grid>\n        \n          <Grid item xs={12} sm={3}>\n            <Button variant=\"contained\" onClick={this.save.bind(this)}>Сохранить</Button>\n          </Grid>\n\n        </Grid>\n      </>\n    )\n  }\n}\n\nexport function AppWorkPoint() {\n  return (\n    <AppWorkPoint_ />\n  );\n}","// extracted by mini-css-extract-plugin\nexport {};\n    if(module.hot) {\n      // 1670331739522\n      var cssReload = require(\"../../../node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"names":["queryString","require","AppWorkPoint_","props","method","data","setState","is_load","fetch","headers","body","stringify","module","state","version","login","localStorage","getItem","JSON","then","res","json","st","type","setTimeout","window","location","pathname","err","console","log","module_name","points","point_id","apps","app_id","allList","allListRender","thisList","this","getData","module_info","name","id","document","title","getWorks","event","target","value","all_work","this_work","checkList","map","Titem","newArr","Aitem","parseInt","push","check","find","item","key","thisItem","time_min","dop_time","new_arr","items","fake_item","length","alert","text","list","isNaN","Backdrop","style","zIndex","open","CircularProgress","color","Grid","container","spacing","xs","sm","func","label","changeApp","bind","Button","variant","onClick","List","width","ListItem","borderBottom","ListItemText","primary","Send","add","Table","size","TableHead","TableRow","TableCell","Close","TableBody","changeDopTime","del","cursor","save","React","AppWorkPoint","cssReload","hot","dispose","accept","undefined"],"sourceRoot":""}