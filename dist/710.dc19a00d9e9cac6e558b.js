"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[710],{710:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S}),a(9364);var n=a(5861),s=a(5671),i=a(3144),o=a(7326),r=a(136),l=a(6215),c=a(1120),m=a(4942),u=a(4687),d=a.n(u),h=a(7294),f=a(30),p=a(1822),w=a(3892),E=a(5705),g=a(8573),v=a(1388),Z=a(1702),x=a(9620),y=a(2962),C=a(4498),k=a(7745),N=a(6406);var _=a(7563),D=function(e){(0,r.Z)(P,e);var t,a,u,D,S,b=(D=P,S=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(D);if(S){var a=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,a)}else e=t.apply(this,arguments);return(0,l.Z)(this,e)});function P(e){var t;return(0,s.Z)(this,P),t=b.call(this,e),(0,m.Z)((0,o.Z)(t),"getData",(function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:_.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(a)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e),t.setState({is_load:!1})}))})),t.state={module:"cat_work",module_name:"",is_load:!1,cats:[],modalDialog:!1,modalDialogNew:!1,nameCat:"",editText:"",nameCatNew:"",editTextNew:"",config:{readonly:!1},showCat:null},t}return(0,i.Z)(P,[{key:"componentDidMount",value:(u=(0,n.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_all");case 2:t=e.sent,this.setState({module_name:t.module_info.name,cats:t.cats}),document.title=t.module_info.name;case 5:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"openCat",value:function(e){this.setState({modalDialog:!0,showCat:e,nameCat:e.name,editText:e.text})}},{key:"save",value:(a=(0,n.Z)(d().mark((function e(){var t,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={cat_id:this.state.showCat.id,name:this.state.nameCat,text:document.getElementById("EditorEdit").value},e.next=3,this.getData("save_edit",t);case 3:if(!1!==(a=e.sent).st){e.next=8;break}alert(a.text),e.next=14;break;case 8:return this.setState({modalDialog:!1,showCat:null,nameCat:""}),document.getElementById("EditorEdit").value="",e.next=12,this.getData("get_all");case 12:a=e.sent,this.setState({cats:a.cats});case 14:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"saveNew",value:(t=(0,n.Z)(d().mark((function e(){var t,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={name:this.state.nameCatNew,text:document.getElementById("EditorNew").value},e.next=3,this.getData("save_new",t);case 3:if(!1!==(a=e.sent).st){e.next=8;break}alert(a.text),e.next=14;break;case 8:return this.setState({modalDialogNew:!1,editTextNew:"",nameCatNew:""}),document.getElementById("EditorNew").value="",e.next=12,this.getData("get_all");case 12:a=e.sent,this.setState({cats:a.cats});case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return h.createElement(h.Fragment,null,h.createElement(w.Z,{style:{zIndex:99},open:this.state.is_load},h.createElement(E.Z,{color:"inherit"})),this.state.showCat?h.createElement(x.Z,{open:this.state.modalDialog,onClose:function(){e.setState({modalDialog:!1,showCat:null,editText:"",nameCat:""})}},h.createElement(k.Z,null,'Категория уборки "',this.state.showCat.name,'"'),h.createElement(C.Z,{style:{paddingTop:10}},h.createElement(f.ZP,{container:!0,spacing:3},h.createElement(f.ZP,{item:!0,xs:12,sm:12},h.createElement(N.rZ,{value:this.state.nameCat,func:function(t){e.setState({nameCat:t.target.value})},label:"Название категории"})),h.createElement(f.ZP,{item:!0,xs:12,sm:12},h.createElement(N.H4,{id:"EditorEdit",text:this.state.showCat.text})))),h.createElement(y.Z,null,h.createElement(p.Z,{color:"primary",onClick:this.save.bind(this)},"Сохранить"))):null,h.createElement(x.Z,{open:this.state.modalDialogNew,onClose:function(){e.setState({modalDialogNew:!1,editTextNew:"",nameCatNew:""})}},h.createElement(k.Z,null,"Новая категория уборки"),h.createElement(C.Z,{style:{paddingTop:10}},h.createElement(f.ZP,{container:!0,spacing:3},h.createElement(f.ZP,{item:!0,xs:12,sm:12},h.createElement(N.rZ,{value:this.state.nameCatNew,func:function(t){e.setState({nameCatNew:t.target.value})},label:"Название категории"})),h.createElement(f.ZP,{item:!0,xs:12,sm:12},h.createElement(N.H4,{id:"EditorNew",text:""})))),h.createElement(y.Z,null,h.createElement(p.Z,{color:"primary",onClick:this.saveNew.bind(this)},"Сохранить"))),h.createElement(f.ZP,{container:!0,spacing:3},h.createElement(f.ZP,{item:!0,xs:12,sm:12},h.createElement("h1",null,this.state.module_name)),h.createElement(f.ZP,{item:!0,xs:12,sm:12},h.createElement(p.Z,{variant:"contained",color:"primary",onClick:function(){e.setState({modalDialogNew:!0})}},"Добавить категорию")),h.createElement(f.ZP,{item:!0,xs:12,sm:12},h.createElement(g.Z,{style:{width:"100%"}},this.state.cats.map((function(t,a){return h.createElement(v.ZP,{button:!0,key:a,onClick:e.openCat.bind(e,t)},h.createElement(Z.Z,{primary:t.name}))}))))))}}]),P}(h.Component);function S(){return h.createElement(D,null)}},9364:(e,t,a)=>{var n=a(4783)(e.id,{locals:!1});e.hot.dispose(n),e.hot.accept(void 0,n)}}]);
//# sourceMappingURL=710.dc19a00d9e9cac6e558b.js.map