"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[546],{9546:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P}),n(4010);var a=n(5861),o=n(5671),i=n(3144),l=n(7326),s=n(136),r=n(6215),c=n(1120),d=n(4942),u=n(4687),h=n.n(u),p=n(7294),m=n(7961),f=n(3646),g=n(30),v=n(1822),y=n(3718),w=n(9670),x=n(1640),S=n(9620),k=n(2962),E=n(4498),Z=n(4439),b=n(7745),T=n(3892),_=n(5705);var D=n(7563),C=function(e){(0,s.Z)(I,e);var t,n,u,C,P=(u=I,C=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,c.Z)(u);if(C){var n=(0,c.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,r.Z)(this,e)});function I(e){var t;return(0,o.Z)(this,I),t=P.call(this,e),(0,d.Z)((0,l.Z)(t),"getData",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:D.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("login"),data:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e)}))})),t.state={module:"auth",module_name:"",is_load:!1,modalDialog:!1,dialogTitle:"",dialogText:"",activeStep:0,steps:["Телефон","Подтверждение","Новый пароль"],phone:"",code:"",pwd:""},t}return(0,i.Z)(I,[{key:"componentDidMount",value:function(){"http:"!=window.location.protocol&&"http"!=window.location.protocol||"localhost"==window.location.hostname||(window.location.href="https://jacosoft-dop.ru"+window.location.pathname)}},{key:"updateData",value:(n=(0,a.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={point_id:this.state.point,showReady:!0===this.state.showReady?1:0},e.next=3,this.getData("get_orders",t);case 3:n=e.sent,this.setState({read:n.read,onstol:n.onstol,ordersQueue:n.prestol_new});case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"nextStep",value:(t=(0,a.Z)(h().mark((function e(){var t,n,a,o,i,l,s=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=this.state.activeStep){e.next=8;break}return t={login:document.getElementById("phone").value},e.next=4,this.getData("check_phone",t);case 4:!1===(n=e.sent).st?setTimeout((function(){s.setState({modalDialog:!0,dialogTitle:"Предупреждение",dialogText:n.text})}),500):this.setState({activeStep:this.state.activeStep+1,phone:t.login}),e.next=22;break;case 8:if(1!=this.state.activeStep){e.next=16;break}return a={login:this.state.phone,code:document.getElementById("code").value},e.next=12,this.getData("check_code",a);case 12:!1===(o=e.sent).st?setTimeout((function(){s.setState({modalDialog:!0,dialogTitle:"Предупреждение",dialogText:o.text})}),500):this.setState({activeStep:this.state.activeStep+1,code:a.code}),e.next=22;break;case 16:if(2!=this.state.activeStep){e.next=22;break}return i={login:this.state.phone,code:this.state.code,pwd:document.getElementById("password").value},e.next=20,this.getData("save_new_pwd",i);case 20:!1===(l=e.sent).st?setTimeout((function(){s.setState({modalDialog:!0,dialogTitle:"Предупреждение",dialogText:l.text})}),500):(localStorage.setItem("token",l.token),setTimeout((function(){window.location.pathname="/"}),300));case 22:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"enterNextStep",value:function(e){13==e.charCode&&this.nextStep()}},{key:"checkPhone",value:function(e){var t,n=event.target.value;t="+"==(n=n.replace(/[^\d+]/gi,"")).substring(0,1)?12:11,n=n.substring(0,t),document.getElementById("phone").value=n}},{key:"render",value:function(){var e=this;return p.createElement(p.Fragment,null,p.createElement(T.Z,{style:{zIndex:99},open:this.state.is_load},p.createElement(_.Z,{color:"inherit"})),p.createElement(S.Z,{open:this.state.modalDialog,onClose:function(){e.setState({modalDialog:!1})},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},p.createElement(b.Z,{id:"alert-dialog-title"},this.state.dialogTitle),p.createElement(E.Z,null,p.createElement(Z.Z,{id:"alert-dialog-description"},this.state.dialogText)),p.createElement(k.Z,null,p.createElement(v.Z,{onClick:function(){e.setState({modalDialog:!1})},color:"primary",autoFocus:!0},"Хорошо"))),p.createElement(g.ZP,{container:!0,spacing:3,direction:"row",justifyContent:"center",alignItems:"center"},p.createElement(g.ZP,{item:!0,xs:12,sm:6,md:6,lg:4,xl:3},p.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},p.createElement(m.Z,{style:{borderRadius:0,width:"100%",height:150,margin:0,backgroundColor:"#fff",marginBottom:20}},p.createElement("img",{alt:"Жако доставка роллов и пиццы",src:"../assets/img_other/Favikon.png",style:{height:"100%"}})),p.createElement(y.Z,{activeStep:this.state.activeStep,alternativeLabel:!0,style:{width:"100%"}},this.state.steps.map((function(e){return p.createElement(w.Z,{key:e},p.createElement(x.Z,null,e))}))),p.createElement("div",{style:{width:"100%"}},0==this.state.activeStep?p.createElement(f.Z,{variant:"outlined",margin:"normal",size:"small",required:!0,fullWidth:!0,id:"phone",label:"Номер телефона",name:"phone",autoComplete:"phone",autoFocus:!0,onKeyPress:this.enterNextStep.bind(this),onChange:this.checkPhone.bind(this)}):null,1==this.state.activeStep?p.createElement(f.Z,{variant:"outlined",margin:"normal",size:"small",required:!0,fullWidth:!0,id:"code",label:"Код из смс",name:"code",autoComplete:"code",autoFocus:!0,onKeyPress:this.enterNextStep.bind(this)}):null,2==this.state.activeStep?p.createElement(f.Z,{variant:"outlined",margin:"normal",size:"small",required:!0,fullWidth:!0,name:"password",label:"Пароль",type:"password",id:"password",autoComplete:"current-password",onKeyPress:this.enterNextStep.bind(this)}):null,p.createElement(v.Z,{fullWidth:!0,variant:"contained",color:"primary",style:{marginTop:10,marginBottom:10},onClick:this.nextStep.bind(this)},"Дальше"),p.createElement(g.ZP,{container:!0},p.createElement(g.ZP,{item:!0,xs:!0},p.createElement("a",{href:"/auth",style:{color:"#c03"}},"Вернуться к авторизации"))))))))}}]),I}(p.Component);function P(){return p.createElement(C,null)}},4010:(e,t,n)=>{var a=n(4783)(e.id,{locals:!1});e.hot.dispose(a),e.hot.accept(void 0,a)}}]);
//# sourceMappingURL=546.faf258ebaa252a490eec.js.map