"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[443],{443:(t,e,a)=>{a.r(e),a.d(e,{default:()=>Y}),a(1271);var n=a(5861),i=a(4942),s=a(5671),l=a(3144),r=a(7326),o=a(136),m=a(6215),u=a(1120),c=a(4687),d=a.n(c),p=a(7294),h=a(30),y=a(1822),v=a(130),f=a(1647),b=a(8720),_=a(3150),E=a(6140),Z=a(3030),g=a(8561),q=a(8736),k=a(3406),S=a(214),w=a(5670),x=a(6568),C=a(3055),I=a(8727),P=a(808),D=a(231),T=a(3508),j=a(9620),R=a(2962),z=a(4498),B=a(7745),M=a(594),N=a(3892),F=a(5705),W=a(6406);function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=(0,u.Z)(t);if(e){var i=(0,u.Z)(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return(0,m.Z)(this,a)}}var U=a(7563);function H(t){var e=new Date(t),a=""+(e.getMonth()+1),n=""+e.getDate(),i=e.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[i,a,n].join("-")}var J=function(t){(0,o.Z)(a,t);var e=O(a);function a(t){var n;return(0,s.Z)(this,a),(n=e.call(this,t)).handleResize=n.handleResize.bind((0,r.Z)(n)),n.state={item:[],date_start:H(new Date),fullScreen:!1},n}return(0,l.Z)(a,[{key:"componentDidUpdate",value:function(t){this.props.event&&this.props.event!==t.event&&this.setState({item:this.props.event})}},{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"handleResize",value:function(){window.innerWidth<601?this.setState({fullScreen:!0}):this.setState({fullScreen:!1})}},{key:"changeTimeStart",value:function(t,e){var a=this.state.item.map((function(a){return a.id_table===t.id_table&&(a.time_start=e.target.value),a}));this.setState({item:a})}},{key:"changeTimeEnd",value:function(t,e){var a=this.state.item.map((function(a){return a.id_table===t.id_table&&(a.time_end=e.target.value),a}));this.setState({item:a})}},{key:"changeItem",value:function(t,e,a){var n=this.state.item.map((function(n){return n.id_table===e.id_table&&n.data.map((function(e){return e.post===t.post&&(e.quantity=Number(a.target.value)),e})),n}));this.setState({item:n})}},{key:"changeDateRange",value:function(t,e){this.setState((0,i.Z)({},t,H(e)))}},{key:"save",value:function(){this.props.save(this,this.state.item,this.state.date_start),this.setState({item:this.props.event?this.props.event:[],date_start:H(new Date)}),this.props.onClose()}},{key:"addItem",value:function(){var t=this.state.item;if(t.length){var e={id:t[0].id,day:t[0].day,id_table:t.length+1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:0},{post:"Повар",quantity:0},{post:"Кухонный работник",quantity:0},{post:"Курьер",quantity:0}]};t.push(e)}else{var a={id:this.props.event[0].id,day:this.props.value,id_table:1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:0},{post:"Повар",quantity:0},{post:"Кухонный работник",quantity:0},{post:"Курьер",quantity:0}]};t.push(a)}this.setState({item:t})}},{key:"deleteItem",value:function(t){var e=this.state.item.filter((function(e){return e.id_table!==t}));this.setState({item:e})}},{key:"onClose",value:function(){this.setState({item:this.props.event?this.props.event:[],date_start:H(new Date)}),this.props.onClose()}},{key:"render",value:function(){var t=this;return p.createElement(j.Z,{open:this.props.open,onClose:this.onClose.bind(this),fullScreen:this.state.fullScreen,fullWidth:!0,maxWidth:"md","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},p.createElement(B.Z,{className:"button"},p.createElement(f.Z,{style:{fontWeight:"normal"}},this.props.method),this.state.fullScreen?p.createElement(v.Z,{onClick:this.onClose.bind(this),style:{cursor:"pointer"}},p.createElement(M.Z,null)):null),p.createElement(z.Z,{style:{paddingBottom:10,paddingTop:10}},p.createElement(h.ZP,{container:!0,spacing:3,mb:3},p.createElement(h.ZP,{item:!0,sm:6},p.createElement(W.Qe,{label:"Дата",value:this.state.date_start,func:this.changeDateRange.bind(this,"date_start")}))),p.createElement(k.Z,null,p.createElement(_.Z,{size:"small",style:{whiteSpace:"nowrap"}},p.createElement(g.Z,null,p.createElement(q.Z,null,p.createElement(Z.Z,{style:{width:"30%"}},"Время"),p.createElement(Z.Z,{style:{width:"30%"}},"Должность"),p.createElement(Z.Z,{style:{width:"20%"}},"Кол-во"),p.createElement(Z.Z,{style:{width:"20%"}}))),this.state.item.map((function(e,a){return p.createElement(p.Fragment,{key:a},p.createElement(E.Z,{key:a+100,sx:{"& td":{border:0},borderBottom:1,borderColor:"divider"}},p.createElement(q.Z,null,p.createElement(Z.Z,{rowSpan:"5"},p.createElement(h.ZP,{item:!0,xs:6,sm:12,mb:2},p.createElement(W.w0,{value:e.time_start,func:t.changeTimeStart.bind(t,e),label:"Время начала"})),p.createElement(h.ZP,{item:!0,xs:6,sm:12},p.createElement(W.w0,{value:e.time_end,func:t.changeTimeEnd.bind(t,e),label:"Время окончания"})))),e.data.map((function(a,n){return p.createElement(q.Z,{key:n+1e3},p.createElement(Z.Z,null,a.post),p.createElement(Z.Z,null,p.createElement(W.rZ,{value:a.quantity,type:"number",func:t.changeItem.bind(t,a,e)})),1!==n?null:p.createElement(Z.Z,{colSpan:"5",align:"center"},p.createElement(M.Z,{fontSize:"large",onClick:t.deleteItem.bind(t,e.id_table),style:{cursor:"pointer"}})))}))))}))))),p.createElement(R.Z,{className:"button"},p.createElement(y.Z,{style:{whiteSpace:"nowrap"},onClick:this.addItem.bind(this)},"Добавить"),p.createElement(y.Z,{style:{color:"#00a550"},onClick:this.save.bind(this)},"Сохранить")))}}]),a}(p.Component),L=function(t){(0,o.Z)(a,t);var e=O(a);function a(t){var n;return(0,s.Z)(this,a),(n=e.call(this,t)).state={item:[]},n}return(0,l.Z)(a,[{key:"componentDidUpdate",value:function(t){this.props.event&&this.props.event!==t.event&&this.setState({item:this.props.event})}},{key:"componentDidMount",value:function(){this.setState({item:this.props.event})}},{key:"changeTimeStart",value:function(t,e){var a=this.state.item.map((function(a){return a.id_table===t.id_table&&(a.time_start=e.target.value),a}));this.setState({item:a})}},{key:"changeTimeEnd",value:function(t,e){var a=this.state.item.map((function(a){return a.id_table===t.id_table&&(a.time_end=e.target.value),a}));this.setState({item:a})}},{key:"changeItem",value:function(t,e,a){var n=this.state.item.map((function(n){return n.id_table===e.id_table&&n.data.map((function(e){return e.post===t.post&&(e.quantity=Number(a.target.value)),e})),n}));this.setState({item:n})}},{key:"addItem",value:function(){var t=this.state.item;if(t.length){var e={id:t[0].id,day:t[0].day,id_table:t.length+1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:0},{post:"Повар",quantity:0},{post:"Кухонный работник",quantity:0},{post:"Курьер",quantity:0}]};t.push(e)}else{var a={id:this.props.event[0].id,day:this.props.value,id_table:1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:0},{post:"Повар",quantity:0},{post:"Кухонный работник",quantity:0},{post:"Курьер",quantity:0}]};t.push(a)}this.setState({item:t})}},{key:"deleteItem",value:function(t){var e=this.state.item.filter((function(e){return e.id_table!==t}));this.setState({item:e})}},{key:"render",value:function(){var t=this;return p.createElement(p.Fragment,null,p.createElement(C.Z,{value:this.props.value,style:{padding:"0"}},p.createElement(h.ZP,{container:!0,spacing:3},this.state.item.map((function(e,a){return p.createElement(p.Fragment,{key:a},p.createElement(h.ZP,{item:!0,xs:8,sm:3},p.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-around",height:"100%",minHeight:120}},p.createElement(W.w0,{value:e.time_start,func:t.changeTimeStart.bind(t,e),label:"Время начала"}),p.createElement(W.w0,{value:e.time_end,func:t.changeTimeEnd.bind(t,e),label:"Время окончания"}))),p.createElement(h.ZP,{item:!0,xs:4,sm:0,sx:{display:{xs:"flex",sm:"none"},justifyContent:"center",alignItems:"center"}},p.createElement(M.Z,{fontSize:"large",onClick:t.deleteItem.bind(t,e.id_table),style:{cursor:"pointer"}})),p.createElement(h.ZP,{item:!0,sm:8},p.createElement("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"}},e.data.map((function(a,n){return p.createElement("div",{key:n+10,style:{display:"flex",flexDirection:"row",alignItems:"center",marginBottom:10}},p.createElement("span",{style:{minWidth:200}},a.post),p.createElement(W.rZ,{value:a.quantity,type:"number",func:t.changeItem.bind(t,a,e)}))})))),p.createElement(h.ZP,{item:!0,xs:4,sm:1,sx:{display:{xs:"none",sm:"flex"},justifyContent:"center",alignItems:"center"}},p.createElement(M.Z,{fontSize:"large",onClick:t.deleteItem.bind(t,e.id_table),style:{cursor:"pointer"}})))})))),p.createElement(h.ZP,{item:!0,sm:12,className:"button"},p.createElement(h.ZP,{container:!0,spacing:3},p.createElement(h.ZP,{item:!0,xs:6,sm:6},p.createElement(y.Z,{variant:"contained",style:{whiteSpace:"nowrap"},onClick:this.addItem.bind(this)},"Добавить")),p.createElement(h.ZP,{item:!0,xs:6,sm:6},p.createElement(y.Z,{variant:"contained",onClick:this.props.save.bind(this,this.state.item),style:{backgroundColor:"#00a550",whiteSpace:"nowrap"}},"Сохранить")))))}}]),a}(p.Component),Q=function(t){(0,o.Z)(m,t);var e,a=O(m);function m(t){var e;return(0,s.Z)(this,m),e=a.call(this,t),(0,i.Z)((0,r.Z)(e),"getData",(function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:U.stringify({method:t,module:e.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(a)})}).then((function(t){return t.json()})).then((function(t){if(!1!==t.st||"redir"!=t.type){if(!1!==t.st||"auth"!=t.type)return setTimeout((function(){e.setState({is_load:!1})}),300),t;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(t){console.log(t)}))})),e.state={module:"count_users",module_name:"",is_load:!1,points:[{id:-1,name:"Выберите точку"},{base:"jaco_rolls_1",name:"Тольятти, Ленинградская 47",id:"1",city_id:"1"},{base:"jaco_rolls_2",name:"Тольятти, Ворошилова 12а",id:"2",city_id:"1"},{base:"jaco_rolls_3",name:"Тольятти, Матросова 32",id:"3",city_id:"1"},{base:"jaco_rolls_6",name:"Тольятти, Цветной 1",id:"6",city_id:"1"},{base:"jaco_rolls_4",name:"Самара, Куйбышева 113",id:"4",city_id:"2"},{base:"jaco_rolls_5",name:"Самара, Победы 10",id:"5",city_id:"2"},{base:"jaco_rolls_7",name:"Самара, Молодёжная 2",id:"7",city_id:"2"}],point:-1,ItemTab:"1",item:[],event:[{id:"1",day:"1",id_table:1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:1},{post:"Повар",quantity:1},{post:"Кухонный работник",quantity:1},{post:"Курьер",quantity:1}]},{id:"1",day:"2",id_table:1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:2},{post:"Повар",quantity:2},{post:"Кухонный работник",quantity:2},{post:"Курьер",quantity:2}]},{id:"1",day:"3",id_table:1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:3},{post:"Повар",quantity:3},{post:"Кухонный работник",quantity:3},{post:"Курьер",quantity:3}]}],data:[{id:"1",data_table:"2022-10-05",time_start:"19:30",time_end:"20:30",data:[{post:"Кассир",quantity:1},{post:"Повар",quantity:1},{post:"Кухонный работник",quantity:1},{post:"Курьер",quantity:1}]},{id:"1",data_table:"2022-10-06",time_start:"20:30",time_end:"21:30",data:[{post:"Кассир",quantity:2},{post:"Повар",quantity:2},{post:"Кухонный работник",quantity:2},{post:"Курьер",quantity:2}]},{id:"1",data_table:"2022-10-07",time_start:"22:30",time_end:"23:30",data:[{post:"Кассир",quantity:3},{post:"Повар",quantity:3},{post:"Кухонный работник",quantity:3},{post:"Курьер",quantity:3}]}],dataPoint:[],modalDialog:!1},e}return(0,l.Z)(m,[{key:"componentDidMount",value:(e=(0,n.Z)(d().mark((function t(){var e;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getData("get_all");case 2:e=t.sent,this.setState({module_name:e.module_info.name});case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"changePoint",value:function(t){var e=this,a=t.target.value,n=this.state.event,i=this.state.data,s=n.filter((function(a){return t.target.value===a.id&&e.state.ItemTab===a.day})),l=i.filter((function(e){return t.target.value===e.id}));if(!s.length){var r={id:a,day:"1",id_table:1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:0},{post:"Повар",quantity:0},{post:"Кухонный работник",quantity:0},{post:"Курьер",quantity:0}]};s.push(r)}this.setState({point:a,dataPoint:l,item:s})}},{key:"changeTab",value:function(t,e){var a=this,n=this.state.event.filter((function(t){return e===t.day&&a.state.point===t.id}));if(!n.length){var i={id:this.state.point,day:e,id_table:1,time_start:"",time_end:"",data:[{post:"Кассир",quantity:0},{post:"Повар",quantity:0},{post:"Кухонный работник",quantity:0},{post:"Курьер",quantity:0}]};n.push(i)}this.setState({ItemTab:e,item:n})}},{key:"openModal",value:function(t,e,a){if("Особый день"===t){var n=[],i={id:this.state.point,data_table:"",time_start:"",time_end:"",data:[{post:"Кассир",quantity:0},{post:"Повар",quantity:0},{post:"Кухонный работник",quantity:0},{post:"Курьер",quantity:0}]};n.push(i),this.setState({modalDialog:!0,method:t,item:n})}"Редактировать особый день"===t&&(a.stopPropagation(),this.setState({modalDialog:!0,method:t,item:[e]}))}},{key:"saveItem",value:function(t,e){}},{key:"deleteItem",value:function(t,e){e.stopPropagation()}},{key:"render",value:function(){var t=this;return p.createElement(p.Fragment,null,p.createElement(N.Z,{style:{zIndex:99},open:this.state.is_load},p.createElement(F.Z,{color:"inherit"})),p.createElement(J,{open:this.state.modalDialog,onClose:function(){t.setState({modalDialog:!1})},method:this.state.method,event:this.state.item,save:this.saveItem.bind(this)}),p.createElement(h.ZP,{container:!0,spacing:3},p.createElement(h.ZP,{item:!0,xs:12},p.createElement("h1",null,this.state.module_name)),p.createElement(h.ZP,{item:!0,xs:12,sm:6},p.createElement(W.$S,{data:this.state.points,value:this.state.point,func:this.changePoint.bind(this),label:"Точка"})),p.createElement(h.ZP,{item:!0,xs:12,sm:6},p.createElement(y.Z,{disabled:this.state.point<1,variant:this.state.point<1?"outlined":"contained",style:{whiteSpace:"nowrap"},onClick:this.openModal.bind(this,"Особый день")},"Добавить особый день")),this.state.point<1?null:p.createElement(h.ZP,{item:!0,xs:12,sm:8},p.createElement(w.ZP,{value:this.state.ItemTab},p.createElement(b.Z,{sx:{borderBottom:1,borderColor:"divider",marginBottom:3}},p.createElement(x.Z,{onChange:this.changeTab.bind(this),variant:"scrollable",scrollButtons:!0,allowScrollButtonsMobile:!0},p.createElement(S.Z,{label:"Понедельник",value:"1"}),p.createElement(S.Z,{label:"Вторник",value:"2"}),p.createElement(S.Z,{label:"Среда",value:"3"}),p.createElement(S.Z,{label:"Четверг",value:"4"}),p.createElement(S.Z,{label:"Пятница",value:"5"}),p.createElement(S.Z,{label:"Суббота",value:"6"}),p.createElement(S.Z,{label:"Воскресенье",value:"7"}))),p.createElement(L,{value:this.state.ItemTab,event:this.state.item,save:this.saveItem.bind(this)}))),this.state.point<1||!this.state.dataPoint.length?null:p.createElement(h.ZP,{item:!0,xs:12,sm:4},p.createElement(I.Z,null,p.createElement(P.Z,{expandIcon:p.createElement(T.Z,null),"aria-controls":"panel1a-content"},p.createElement(f.Z,null,"Даты")),p.createElement(D.Z,null,this.state.dataPoint.map((function(e,a){return p.createElement(I.Z,{key:a},p.createElement(P.Z,{expandIcon:p.createElement(M.Z,{onClick:t.deleteItem.bind(t,e)})},p.createElement(f.Z,{onClick:t.openModal.bind(t,"Редактировать особый день",e)},e.data_table)))})))))))}}]),m}(p.Component);function Y(){return p.createElement(Q,null)}},1271:(t,e,a)=>{var n=a(4783)(t.id,{locals:!1});t.hot.dispose(n),t.hot.accept(void 0,n)}}]);
//# sourceMappingURL=443.35ba5d748fe20b12fb6e.js.map