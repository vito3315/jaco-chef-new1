{"version":3,"file":"669.dc3efe7d6532a9f0fb89.js","mappings":"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","sources":["webpack://package.json/./src/components/vendor_item_price/vendor_item_price.component.jsx","webpack://package.json/./src/components/vendor_item_price/vendor_item_price.style.scss"],"sourcesContent":["import React from 'react';\r\n\r\nimport Grid from '@mui/material/Grid';\r\nimport Button from '@mui/material/Button';\r\n\r\nimport Table from '@mui/material/Table';\r\nimport TableBody from '@mui/material/TableBody';\r\nimport TableCell from '@mui/material/TableCell';\r\nimport TableContainer from '@mui/material/TableContainer';\r\nimport TableHead from '@mui/material/TableHead';\r\nimport TableRow from '@mui/material/TableRow';\r\nimport Paper from '@mui/material/Paper';\r\n\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogContentText from '@mui/material/DialogContentText';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\n\r\nimport Backdrop from '@mui/material/Backdrop';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\n\r\nimport { MySelect, MyCheckBox, MyTextInput, MyAutocomplite } from '../../stores/elements';\r\n\r\nconst queryString = require('query-string');\r\n\r\nclass VendorItemPrice_ extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n        \r\n    this.state = {\r\n      module: 'vendor_item_price',\r\n      module_name: '',\r\n      is_load: false,\r\n      \r\n      modalDialog: false,\r\n      \r\n      vendors: [],\r\n      vendor: null,\r\n      \r\n      items: [],\r\n      \r\n      cities: [],\r\n      city: '',\r\n      allCity: false,\r\n      isPrioriti: false\r\n    };\r\n  }\r\n  \r\n  async componentDidMount(){\r\n    \r\n    let data = await this.getData('get_all');\r\n    \r\n    this.setState({\r\n      module_name: data.module_info.name,\r\n      cities: data.cities\r\n    })\r\n    \r\n    document.title = data.module_info.name;\r\n  }\r\n  \r\n  getData = (method, data = {}) => {\r\n    \r\n    this.setState({\r\n      is_load: true\r\n    })\r\n    \r\n    return fetch('https://jacochef.ru/api/index_new.php', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type':'application/x-www-form-urlencoded'},\r\n      body: queryString.stringify({\r\n        method: method, \r\n        module: this.state.module,\r\n        version: 2,\r\n        login: localStorage.getItem('token'),\r\n        data: JSON.stringify( data )\r\n      })\r\n    }).then(res => res.json()).then(json => {\r\n      \r\n      if( json.st === false && json.type == 'redir' ){\r\n        window.location.pathname = '/';\r\n        return;\r\n      }\r\n      \r\n      if( json.st === false && json.type == 'auth' ){\r\n        window.location.pathname = '/auth';\r\n        return;\r\n      }\r\n      \r\n      setTimeout( () => {\r\n        this.setState({\r\n          is_load: false\r\n        })\r\n      }, 300 )\r\n      \r\n      return json;\r\n    })\r\n    .catch(err => { \r\n      setTimeout( () => {\r\n        this.setState({\r\n          is_load: false\r\n        })\r\n      }, 300 )\r\n      console.log( err )\r\n    });\r\n  }\r\n   \r\n  async changeCity(event){\r\n    let data = {\r\n      city: event.target.value\r\n    }\r\n    \r\n    let res = await this.getData('get_vendors', data);\r\n    \r\n    this.setState({\r\n      vendors: res,\r\n      city: event.target.value,\r\n      vendor: null,\r\n      items: []\r\n    })\r\n  }\r\n  \r\n  async changeVendor(event, value){\r\n\r\n    console.log( event.target.value, value )\r\n\r\n    let data = {\r\n      city: this.state.city,\r\n      vendor_id: value.id,\r\n    }\r\n    \r\n    let res = await this.getData('get_vendor_items', data);\r\n    \r\n    this.setState({\r\n      items: res,\r\n      vendor: value,\r\n    })\r\n  }\r\n  \r\n  update(item_id, data, event){\r\n    let this_items = this.state.items;\r\n    \r\n    this_items.map( (item, key) => {\r\n      if( parseInt(item.item_id) == parseInt(item_id) ){\r\n        this_items[key][data] = event.target.value;\r\n        \r\n        this_items[key]['price'] = (parseFloat(this_items[key]['full_price']) / parseFloat(this_items[key]['rec_pq'])).toFixed(2);\r\n      }\r\n    } )\r\n    \r\n    this.setState({\r\n      items: this_items\r\n    })\r\n  }\r\n  \r\n  async save(){\r\n    let data = {\r\n      vendor_id: this.state.vendor.id,\r\n      items: this.state.items,\r\n      city_id: this.state.city,\r\n      all_city: this.state.allCity === true ? 1 : 0,\r\n      is_prioriti: this.state.isPrioriti === true ? 1 : 0,\r\n    }\r\n    \r\n    if( data.all_city == 1 ){\r\n      if( confirm(\"Точно сохранить на все города поставщика ?\") ){\r\n        let res = await this.getData('save_price', data);\r\n      }\r\n    }else{\r\n      let res = await this.getData('save_price', data);\r\n    }\r\n  }\r\n  \r\n  render(){\r\n    return (\r\n      <>\r\n        <Backdrop style={{ zIndex: 999 }} open={this.state.is_load}>\r\n          <CircularProgress color=\"inherit\" />\r\n        </Backdrop>\r\n        \r\n        <Dialog\r\n          open={this.state.modalDialog}\r\n          onClose={ () => { this.setState({ modalDialog: false }) } }\r\n          aria-labelledby=\"alert-dialog-title\"\r\n          aria-describedby=\"alert-dialog-description\"\r\n        >\r\n          <DialogTitle id=\"alert-dialog-title\"></DialogTitle>\r\n          <DialogContent>\r\n            <DialogContentText id=\"alert-dialog-description\">\r\n            \r\n            </DialogContentText>\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button color=\"primary\">Сохранить</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n        \r\n        \r\n        <Grid container spacing={3}>\r\n          <Grid item xs={12} sm={12}>\r\n            <h1>{this.state.module_name}</h1>\r\n          </Grid>\r\n          \r\n          <Grid item xs={12} sm={3}>\r\n            <MySelect data={this.state.cities} value={this.state.city} func={ this.changeCity.bind(this) } label='Город' />\r\n          </Grid>\r\n          <Grid item xs={12} sm={3}>\r\n            <MyAutocomplite data={this.state.vendors} value={this.state.vendor} func={ this.changeVendor.bind(this) } multiple={false} label='Поставщик' />\r\n          </Grid>\r\n          <Grid item xs={12} sm={3}>\r\n            <MyCheckBox value={this.state.allCity} func={ (event) => { this.setState({ allCity: event.target.checked }) } } label='На все города поставщика' />\r\n          </Grid>\r\n          <Grid item xs={12} sm={12}>\r\n            <MyCheckBox value={this.state.isPrioriti} func={ (event) => { this.setState({ isPrioriti: event.target.checked }) } } label='Приоритетный постащик' />\r\n          </Grid>\r\n          \r\n          <Grid item xs={12}>\r\n            <Button onClick={this.save.bind(this)} variant=\"contained\">Сохранить</Button>\r\n          </Grid>\r\n          \r\n          \r\n          <Grid item xs={12}>\r\n              \r\n            <TableContainer component={Paper}>\r\n              <Table>\r\n                <TableHead>\r\n                  <TableRow>\r\n                    <TableCell>Позиция</TableCell>\r\n                    <TableCell></TableCell>\r\n                    <TableCell>Комментарий</TableCell>\r\n                    <TableCell>Цена за упаковку</TableCell>\r\n                    <TableCell>Объем упаковки</TableCell>\r\n                    <TableCell>Цена за 1 ед.</TableCell>\r\n                  </TableRow>\r\n                </TableHead>\r\n                <TableBody>\r\n                  { this.state.items.map( (item, key) => \r\n                    <TableRow key={key}>\r\n                      <TableCell>{item.name}</TableCell>\r\n                      <TableCell>{item.name_for_vendor}</TableCell>\r\n                      <TableCell>\r\n                        <MyTextInput label=\"\" value={item.comment} func={ this.update.bind(this, item.item_id, 'comment') } multiline={true} maxRows={5} />\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <MyTextInput label=\"\" value={item.full_price} func={ this.update.bind(this, item.item_id, 'full_price') } />\r\n                      </TableCell>\r\n                      <TableCell>\r\n                        <MySelect data={item.pqs} value={ item.rec_pq == 0 || item.rec_pq == '0' ? '' : item.rec_pq } func={ this.update.bind(this, item.item_id, 'rec_pq') } label='' />\r\n                      </TableCell>\r\n                      <TableCell>{item.price} / {item.ei_name}</TableCell>\r\n                    </TableRow>\r\n                  ) }\r\n                </TableBody>\r\n              </Table>\r\n            </TableContainer>\r\n            \r\n          </Grid>\r\n            \r\n          \r\n        </Grid>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport function VendorItemPrice() {\r\n  return (\r\n    <VendorItemPrice_ />\r\n  );\r\n}","// extracted by mini-css-extract-plugin\nexport {};\n    if(module.hot) {\n      // 1669208550583\n      var cssReload = require(\"../../../node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"names":["queryString","require","VendorItemPrice_","props","method","data","setState","is_load","fetch","headers","body","stringify","module","state","version","login","localStorage","getItem","JSON","then","res","json","st","type","setTimeout","window","location","pathname","err","console","log","module_name","modalDialog","vendors","vendor","items","cities","city","allCity","isPrioriti","this","getData","module_info","name","document","title","event","target","value","vendor_id","id","item_id","this_items","map","item","key","parseInt","parseFloat","toFixed","city_id","all_city","is_prioriti","confirm","Backdrop","style","zIndex","open","CircularProgress","color","Dialog","onClose","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","Grid","container","spacing","xs","sm","func","changeCity","bind","label","changeVendor","multiple","checked","onClick","save","variant","TableContainer","component","Paper","Table","TableHead","TableRow","TableCell","TableBody","name_for_vendor","comment","update","multiline","maxRows","full_price","pqs","rec_pq","price","ei_name","React","VendorItemPrice","cssReload","hot","dispose","accept","undefined"],"sourceRoot":""}