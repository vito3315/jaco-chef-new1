"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[13],{5013:(e,t,n)=>{n.r(t),n.d(t,{default:()=>B}),n(8678);var a=n(5861),r=n(7326),l=n(4942),i=n(5671),s=n(3144),o=n(136),c=n(6215),d=n(1120),u=n(4687),m=n.n(u),p=n(7294),h=n(30),Z=n(1822),f=n(3150),E=n(6140),_=n(3030),v=n(8561),y=n(8736),g=n(3406),b=n(5722),k=n(9620),O=n(4498),w=n(7745),x=n(6818),S=n(4048),D=n(888),C=n(6406);function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,d.Z)(e);if(t){var r=(0,d.Z)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,c.Z)(this,n)}}var P=n(7563);function R(e){var t=new Date(e),n=""+(t.getMonth()+1),a=""+t.getDate(),r=t.getFullYear();return n.length<2&&(n="0"+n),a.length<2&&(a="0"+a),[r,n,a].join("-")}var M=function(e){(0,o.Z)(n,e);var t=j(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"shouldComponentUpdate",value:function(e){return!0}},{key:"render",value:function(){var e=this;return p.createElement(g.Z,{component:b.Z},p.createElement(f.Z,null,p.createElement(v.Z,null,p.createElement(y.Z,null,p.createElement(_.Z,null,"#"),p.createElement(_.Z,null,"Номер заказа"),p.createElement(_.Z,null,"Точка"),p.createElement(_.Z,null,"Тип заказа"),p.createElement(_.Z,null,"Номер кассы"),p.createElement(_.Z,null,"Сумма заказа"),p.createElement(_.Z,null,"Дата/Время заказа"),p.createElement(_.Z,null,"Найти заказ"),p.createElement(_.Z,null,"Сохранить"))),p.createElement(E.Z,null,this.props.orders.map((function(t,n){return p.createElement(y.Z,{key:n},p.createElement(_.Z,null,n+1),p.createElement(_.Z,null,p.createElement(C.rZ,{value:t.order_id})),p.createElement(_.Z,null,t.addr),p.createElement(_.Z,null,t.type),p.createElement(_.Z,null,t.kassa),p.createElement(_.Z,null,t.sum),p.createElement(_.Z,null,t.date," ",t.time),p.createElement(_.Z,null,p.createElement(Z.Z,{onClick:e.props.openModal.bind(e,t.sum,t.date,n,t.point_id)},p.createElement(S.Z,{className:"icon"}))),p.createElement(_.Z,null,p.createElement(Z.Z,{onClick:e.props.saveOrder.bind(e,t.id,t.order_id,t.point_id)},p.createElement(x.Z,{className:"icon"}))))})))))}}]),n}(p.Component),T=function(e){(0,o.Z)(n,e);var t=j(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"shouldComponentUpdate",value:function(e){return console.log("orders_in",this.props.orders),!0}},{key:"render",value:function(){var e=this;return p.createElement(g.Z,{component:b.Z},p.createElement(f.Z,null,p.createElement(v.Z,null,p.createElement(y.Z,null,p.createElement(_.Z,null,"#"),p.createElement(_.Z,null,"Номер заказа"),p.createElement(_.Z,null,"Точка"),p.createElement(_.Z,null,"Дата/Время заказа"),p.createElement(_.Z,null,"Тип заказа"),p.createElement(_.Z,null,"Сумма заказа"),p.createElement(_.Z,null,"Выбрать"))),p.createElement(E.Z,null,this.props.orders.map((function(t,n){return p.createElement(y.Z,{key:n},p.createElement(_.Z,null,n+1),p.createElement(_.Z,null,t.id),p.createElement(_.Z,null,t.addr),p.createElement(_.Z,null,t.date),p.createElement(_.Z,null,t.type),p.createElement(_.Z,null,t.sum),p.createElement(_.Z,null,p.createElement(Z.Z,{style:{cursor:"pointer"},onClick:e.props.selectOrder.bind(e,t.id)},p.createElement(D.Z,{className:"icon"}))))})))))}}]),n}(p.Component),N=function(e){(0,o.Z)(f,e);var t,n,c,d,u=j(f);function f(e){var t;(0,i.Z)(this,f),t=u.call(this,e),(0,l.Z)((0,r.Z)(t),"getData",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return 1==a&&t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:P.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){setTimeout((function(){t.setState({is_load:!1})}),300),console.log(e)}))}));var n=new Date;return n.setDate(n.getDate()-5),t.state={module:"check_check",module_name:"Проверка чеков",is_load:!1,point_list:[{id:-1,name:"Все точки"},{base:"jaco_rolls_1",name:"Тольятти, Ленинградская 47",id:"1",city_id:"1"},{base:"jaco_rolls_2",name:"Тольятти, Ворошилова 12а",id:"2",city_id:"1"},{base:"jaco_rolls_3",name:"Тольятти, Матросова 32",id:"3",city_id:"1"},{base:"jaco_rolls_6",name:"Тольятти, Цветной 1",id:"6",city_id:"1"},{base:"jaco_rolls_4",name:"Самара, Куйбышева 113",id:"4",city_id:"2"},{base:"jaco_rolls_5",name:"Самара, Победы 10",id:"5",city_id:"2"},{base:"jaco_rolls_7",name:"Самара, Молодёжная 2",id:"7",city_id:"2"}],point_id:0,type:0,select_list:[{id:"1",name:"выгрузить из налоговой"},{id:"2",name:"удалить все данные"},{id:"3",name:"очистить для 1с"},{id:"4",name:"выгрузить для 1с"},{id:"5",name:"сверить сумму за месяц"},{id:"6",name:"сверить сумму по дням"},{id:"7",name:"есть у нас, но нету в налоговой"},{id:"8",name:"не завершенные заказы"},{id:"9",name:"очистить для 1с"}],date_start:R(n),date_end:R(new Date),allOrder:[],orders:[],order:{},modalOrder:!1,number_order:{}},t}return(0,s.Z)(f,[{key:"componentDidMount",value:(d=(0,a.Z)(m().mark((function e(){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("test");case 1:case"end":return e.stop()}}),e)}))),function(){return d.apply(this,arguments)})},{key:"changeSort",value:function(e,t,n){"app_id"==e?this.setState({app_id:null!=n?n.id:0,app_filter:n}):this.setState((0,l.Z)({},e,t.target.value))}},{key:"changeDateRange",value:function(e,t){this.setState((0,l.Z)({},e,R(t)))}},{key:"openOrder",value:(c=(0,a.Z)(m().mark((function e(t){var n,a;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("pointt_id",this.state.point_id),console.log("type",this.state.type),n={date_start:this.state.date_start,date_end:this.state.date_end,point_id:this.state.point_id,type:this.state.type},e.next=5,this.getData("show",n);case 5:if((a=e.sent).st){e.next=9;break}return alert(a.text),e.abrupt("return",!1);case 9:console.log("res_type",a.type),a.to_del&&alert(a.text),a.orders&&this.setState({allOrder:a.orders});case 12:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"selectOrder",value:function(e){var t=this.state.allOrder,n=this.state.row_numb;t.map((function(t,a){return n===a?t.order_id=e:0})),this.setState({allOrder:t,modalOrder:!1})}},{key:"openModal",value:(n=(0,a.Z)(m().mark((function e(t,n,a,r){var l,i;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={sum:t,point_id:r,date:n,type:this.state.type},console.log("modal_data",l),console.log("row_numb",a),e.next=5,this.getData("find_order",l);case 5:i=e.sent,console.log("res",i),this.setState({modalOrder:!0,orders:i.orders,row_numb:a});case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,a,r){return n.apply(this,arguments)})},{key:"saveOrder",value:(t=(0,a.Z)(m().mark((function e(t,n,a){var r,l;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={id:t,order_id:n,point_id:a},console.log("data",r),e.next=4,this.getData("saveItem",r);case 4:1==(l=e.sent).st?(console.log("save ok"),this.openOrder(),alert("Данные сохранены")):(console.log("save err"),alert(l.text));case 6:case"end":return e.stop()}}),e,this)}))),function(e,n,a){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return p.createElement(p.Fragment,null,p.createElement(h.ZP,{container:!0,spacing:3},p.createElement(h.ZP,{item:!0,xs:12,sm:12},p.createElement("h1",null,this.state.module_name)),p.createElement(h.ZP,{item:!0,xs:12,sm:3},p.createElement(C.Qe,{label:"Начало периода",value:this.state.date_start,func:this.changeDateRange.bind(this,"date_start")})),p.createElement(h.ZP,{item:!0,xs:12,sm:3},p.createElement(C.Qe,{label:"Конец периода",value:this.state.date_end,func:this.changeDateRange.bind(this,"date_end")})),p.createElement(h.ZP,{item:!0,xs:12,sm:3},p.createElement(C.$S,{data:this.state.point_list,value:this.state.point_id.id,func:this.changeSort.bind(this,"point_id"),label:"Точка"})),p.createElement(h.ZP,{item:!0,xs:12,sm:3},p.createElement(C.$S,{data:this.state.select_list,value:this.state.type,func:this.changeSort.bind(this,"type"),label:"Селект"})),p.createElement(h.ZP,{item:!0,xs:12,sm:3},p.createElement(Z.Z,{onClick:this.openOrder.bind(this),variant:"contained"},"Выполнить")),p.createElement(h.ZP,{item:!0,xs:12},this.state.allOrder.length>0?p.createElement(M,{orders:this.state.allOrder,openModal:this.openModal.bind(this),saveOrder:this.saveOrder.bind(this)}):null)),p.createElement(k.Z,{open:this.state.modalOrder,fullWidth:!0,maxWidth:"md",onClose:function(){e.setState({modalOrder:!1})},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},p.createElement(w.Z,null,"Заказы"),p.createElement(O.Z,{style:{paddingBottom:10,paddingTop:10}},p.createElement(h.ZP,{container:!0,spacing:3},this.state.orders&&!0===this.state.modalOrder?p.createElement(T,{orders:this.state.orders,selectOrder:this.selectOrder.bind(this)}):null))))}}]),f}(p.Component);function B(){return p.createElement(N,null)}},8678:(e,t,n)=>{var a=n(4783)(e.id,{locals:!1});e.hot.dispose(a),e.hot.accept(void 0,a)}}]);
//# sourceMappingURL=13.d87bcaf44e5e989194a6.js.map