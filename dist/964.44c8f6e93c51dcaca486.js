"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[964],{964:(t,e,a)=>{a.r(e),a.d(e,{default:()=>I}),a(7709);var n=a(5861),i=a(5671),s=a(3144),o=a(7326),l=a(136),c=a(6215),r=a(1120),u=a(4942),h=a(4687),f=a.n(h),d=a(7294),m=a(30),p=a(1822),v=a(3892),y=a(5705),g=a(6406),Z=a(6388),k=a.n(Z);var _=a(7563),E=function(t){(0,l.Z)(b,t);var e,a,h,Z,E,I=(Z=b,E=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=(0,r.Z)(Z);if(E){var a=(0,r.Z)(this).constructor;t=Reflect.construct(e,arguments,a)}else t=e.apply(this,arguments);return(0,c.Z)(this,t)});function b(t){var e;return(0,i.Z)(this,b),e=I.call(this,t),(0,u.Z)((0,o.Z)(e),"getData",(function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:_.stringify({method:t,module:e.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(a)})}).then((function(t){return t.json()})).then((function(t){if(!1!==t.st||"redir"!=t.type){if(!1!==t.st||"auth"!=t.type)return setTimeout((function(){e.setState({is_load:!1})}),300),t;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(t){console.log(t),e.setState({is_load:!1})}))})),e.state={module:"socialnetwork",module_name:"",is_load:!1,cityList:[],city_id:0,dataInfo:null,file:null},e}return(0,s.Z)(b,[{key:"componentDidMount",value:(h=(0,n.Z)(f().mark((function t(){var e,a=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getData("get_all");case 2:e=t.sent,this.setState({module_name:e.module_info.name,cityList:e.cities,city_id:e.cities[0].id}),document.title=e.module_info.name,setTimeout((function(){a.updateData()}),50);case 6:case"end":return t.stop()}}),t,this)}))),function(){return h.apply(this,arguments)})},{key:"changeCity",value:function(t){var e=this,a=t.target.value;this.setState({city_id:a,dataInfo:null,file:null}),setTimeout((function(){e.updateData()}),50)}},{key:"updateData",value:(a=(0,n.Z)(f().mark((function t(){var e,a;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={city_id:this.state.city_id},t.next=3,this.getData("get_data",e);case 3:a=t.sent,this.setState({dataInfo:a,file:null});case 5:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"changeData",value:function(t,e){var a=e.target.value,n=this.state.dataInfo;n[[t]]=a,this.setState({dataInfo:n})}},{key:"saveData",value:(e=(0,n.Z)(f().mark((function t(){var e,a,n=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e={city_id:this.state.city_id,vk:this.state.dataInfo.vk,inst:this.state.dataInfo.inst,ok:this.state.dataInfo.ok,tg:this.state.dataInfo.tg,fb:this.state.dataInfo.fb,file1:this.state.file?this.state.file.name:""},t.next=3,this.getData("save_data",e);case 3:t.sent,this.state.file&&(setTimeout((function(){n.setState({is_load:!0})}),350),(a=new FormData).append("file",this.state.file,this.state.file.name),k().post("https://jacochef.ru/api/files/v2/upload/upload.php",a).then((function(t){console.log(t),n.setState({is_load:!1,file:null})})).catch((function(t){console.log(t)})));case 5:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"handleFileInput",value:function(t){var e=t.target.files[0];console.log(e),this.setState({file:e})}},{key:"render",value:function(){return d.createElement(d.Fragment,null,d.createElement(v.Z,{style:{zIndex:99},open:this.state.is_load},d.createElement(y.Z,{color:"inherit"})),d.createElement(m.ZP,{container:!0,spacing:3},d.createElement(m.ZP,{item:!0,xs:12,sm:12},d.createElement("h1",null,this.state.module_name)),d.createElement(m.ZP,{item:!0,xs:6,sm:6},d.createElement(g.$S,{data:this.state.cityList,value:this.state.city_id,func:this.changeCity.bind(this),label:"Город"})),null==this.state.dataInfo?null:d.createElement(m.ZP,{item:!0,xs:12},d.createElement(m.ZP,{container:!0,spacing:3},d.createElement(m.ZP,{item:!0,xs:12,sm:6},d.createElement(g.rZ,{label:"Вконтакте",value:this.state.dataInfo?this.state.dataInfo.vk:"",func:this.changeData.bind(this,"vk")})),d.createElement(m.ZP,{item:!0,xs:12,sm:6},d.createElement(g.rZ,{label:"Инстаграм",value:this.state.dataInfo?this.state.dataInfo.inst:"",func:this.changeData.bind(this,"inst")})),d.createElement(m.ZP,{item:!0,xs:12,sm:6},d.createElement(g.rZ,{label:"Одноклассники",value:this.state.dataInfo?this.state.dataInfo.ok:"",func:this.changeData.bind(this,"ok")})),d.createElement(m.ZP,{item:!0,xs:12,sm:6},d.createElement(g.rZ,{label:"Телеграм",value:this.state.dataInfo?this.state.dataInfo.tg:"",func:this.changeData.bind(this,"tg")})),d.createElement(m.ZP,{item:!0,xs:12,sm:6},d.createElement(g.rZ,{label:"Facebook",value:this.state.dataInfo?this.state.dataInfo.fb:"",func:this.changeData.bind(this,"fb")})),d.createElement(m.ZP,{item:!0,xs:12,sm:6},d.createElement(g.rZ,{type:"file",label:"",func:this.handleFileInput.bind(this)})),d.createElement(m.ZP,{item:!0,xs:12,sm:6},d.createElement(p.Z,{variant:"contained",onClick:this.saveData.bind(this)},"Обновить данные"))))))}}]),b}(d.Component);function I(){return d.createElement(E,null)}},7709:(t,e,a)=>{var n=a(4783)(t.id,{locals:!1});t.hot.dispose(n),t.hot.accept(void 0,n)}}]);
//# sourceMappingURL=964.44c8f6e93c51dcaca486.js.map