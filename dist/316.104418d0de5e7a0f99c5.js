"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[316],{7316:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O}),n(2734);var i=n(5861),a=n(7326),r=n(4942),l=n(5671),s=n(3144),m=n(136),c=n(6215),o=n(1120),d=n(4687),u=n.n(d),h=n(7294),p=n(30),f=n(1822),v=n(4373),Z=n(8720),E=n(2961),_=n(2450),y=n(3150),g=n(6140),b=n(3030),z=n(8561),k=n(8736),I=n(214),w=n(5670),q=n(6568),C=n(3055),S=n(6540),x=n(594),P=n(9620),R=n(2962),N=n(4498),D=n(7745),M=n(3892),Q=n(5705),T=n(6406);function U(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=(0,o.Z)(e);if(t){var a=(0,o.Z)(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return(0,c.Z)(this,n)}}var F=n(7563),A=function(e){(0,m.Z)(n,e);var t=U(n);function n(e){var i;return(0,l.Z)(this,n),(i=t.call(this,e)).state={item:null,searchValue:""},i}return(0,s.Z)(n,[{key:"searchPf",value:function(e){this.setState({searchValue:e.target.value})}},{key:"render",value:function(){var e=this;return h.createElement(p.ZP,{container:!0,spacing:3},h.createElement(p.ZP,{item:!0,xs:12},h.createElement(p.ZP,{container:!0,spacing:3,mb:2},h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(T.rZ,{label:"Наименование рецепта",value:this.state.item.name,func:this.props.changeItem.bind(this,"name")})),h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(T.rZ,{label:"Время приготовления 1кг (ММ:СС)",value:this.state.item.time_stagе,func:this.props.changeItem.bind(this,"time_stagе")}))),h.createElement(p.ZP,{container:!0,spacing:3,mb:2},h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(T.rZ,{label:"Срок хранения",value:this.state.item.term,func:this.props.changeItem.bind(this,"term")})),h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(T.e_,{label:"Должность на кухне",multiple:!1,data:this.state.item.post,value:this.state.item.post.id,func:function(t,n){var i=e.state.item;i.post.id=n,e.setState({item:i})}}))),h.createElement(p.ZP,{item:!0,xs:12,mb:3},h.createElement(T.e_,{label:"Места хранения",multiple:!0,data:this.state.item.location,value:this.state.item.location.id,func:function(t,n){var i=e.state.item;i.location.id=n,e.setState({item:i})}})),"Редактирование рецепта"===this.props.method?h.createElement(p.ZP,{item:!0,xs:12},h.createElement(T.IA,{label:"Активность",value:1==parseInt(this.state.item.is_show),func:this.props.changeItemChecked.bind(this,"is_show")})):null,h.createElement(v.Z,null),h.createElement(p.ZP,{container:!0,spacing:3,mt:1},h.createElement(p.ZP,{item:!0,xs:12,sm:6},h.createElement(T.rZ,{label:"Поиск",value:this.state.searchValue,func:this.searchPf.bind(this)}),h.createElement(y.Z,{size:"small",style:{whiteSpace:"nowrap"}},h.createElement(z.Z,null,h.createElement(k.Z,null,h.createElement(b.Z,null,"Название"),h.createElement(b.Z,null,"Кол-во"),h.createElement(b.Z,null,"Ед измер"),h.createElement(b.Z,null))),h.createElement(g.Z,null,this.state.item.pf_list.filter((function(t){return""===e.state.searchValue||e.state.searchValue.length<2?t:t.name.toLowerCase().includes(e.state.searchValue.toLowerCase())})).map((function(t,n){return h.createElement(k.Z,{key:n},h.createElement(b.Z,null,t.name),h.createElement(b.Z,null,h.createElement(T.rZ,{type:"number",defaultValue:"",func:e.props.changeQuantity.bind(e)})),h.createElement(b.Z,null,t.ed_izmer),h.createElement(b.Z,null,h.createElement(S.Z,{onClick:e.props.addIngredientsRecipe.bind(e,t),style:{cursor:"pointer"}})))}))))),h.createElement(p.ZP,{item:!0,xs:12,sm:6,mt:5},h.createElement(y.Z,{size:"small",style:{whiteSpace:"nowrap"}},h.createElement(z.Z,null,h.createElement(k.Z,null,h.createElement(b.Z,null,"Название"),h.createElement(b.Z,null,"Кол-во"),h.createElement(b.Z,null,"%"),h.createElement(b.Z,null))),h.createElement(g.Z,null,this.state.item.recipe.map((function(t,n){return h.createElement(k.Z,{key:n},h.createElement(b.Z,null,t.name),h.createElement(b.Z,null,t.quantity," ",t.ed_izmer),h.createElement(b.Z,null,"".concat(t.percent," %")),h.createElement(b.Z,null,h.createElement(x.Z,{onClick:e.props.deleteIngredientsRecipe.bind(e,t.id),style:{cursor:"pointer"}})))})),h.createElement(k.Z,{sx:{"& td":{border:0}}},h.createElement(b.Z,null,"Всего:"),h.createElement(b.Z,null,"".concat(this.props.total," гр")))))))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.event&&e.event!==t.event?{item:e.event}:null}}]),n}(h.Component),V=function(e){(0,m.Z)(n,e);var t=U(n);function n(e){var i;return(0,l.Z)(this,n),(i=t.call(this,e)).state={item:null,quantity:"",total:""},console.log(i.state.item),i}return(0,s.Z)(n,[{key:"changeItem",value:function(e,t){var n=this.state.item;n[e]=t.target.value,this.setState({item:n})}},{key:"changeQuantity",value:function(e){this.setState({quantity:e.target.value})}},{key:"addIngredientsRecipe",value:function(e){var t=this.state.item;if(!(t.recipe.find((function(t){return t.id===e.id}))||this.state.quantity<1)){e.quantity=this.state.quantity,t.recipe.push(e);var n=t.recipe.reduce((function(e,t){return e+Number(t.quantity)}),0)/100;t.recipe.map((function(e){return e.percent=(e.quantity/n).toFixed(2)}));var i=t.recipe.reduce((function(e,t){return e+Number(t.quantity)}),0);this.setState({item:t,quantity:"",total:i})}}},{key:"deleteIngredientsRecipe",value:function(e){var t=this.state.item,n=t.recipe.filter((function(t){return t.id!==e}));t.recipe=n;var i=t.recipe.reduce((function(e,t){return e+Number(t.quantity)}),0)/100;t.recipe.map((function(e){return e.percent=(e.quantity/i).toFixed(2)}));var a=t.recipe.reduce((function(e,t){return e+Number(t.quantity)}),0);this.setState({item:n,total:a})}},{key:"onClose",value:function(){this.setState({item:null,quantity:"",total:""}),this.props.onClose()}},{key:"render",value:function(){return h.createElement(P.Z,{open:this.props.open,fullWidth:!0,maxWidth:"lg",onClose:this.onClose.bind(this)},h.createElement(D.Z,null,this.props.method),h.createElement(N.Z,{style:{paddingBottom:10,paddingTop:10}},h.createElement(A,{method:this.props.method,event:this.state.item,changeItem:this.changeItem.bind(this),addIngredientsRecipe:this.addIngredientsRecipe.bind(this),changeQuantity:this.changeQuantity.bind(this),deleteIngredientsRecipe:this.deleteIngredientsRecipe.bind(this),total:this.state.total})),h.createElement(R.Z,null,h.createElement(f.Z,{onClick:this.props.save.bind(this,this.state.item),color:"primary"},"Сохранить")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.event&&e.event!==t.event?{item:e.event}:null}}]),n}(h.Component),B=function(e){(0,m.Z)(n,e);var t=U(n);function n(e){var i;return(0,l.Z)(this,n),(i=t.call(this,e)).state={item:null,ItemTab:"2",quantity:"",total:""},i}return(0,s.Z)(n,[{key:"changeItem",value:function(e,t){var n=this.state.item;n[e]=t.target.value,this.setState({item:n})}},{key:"changeItemChecked",value:function(e,t){var n=this.state.item;n[e]=!0===t.target.checked?1:0,this.setState({item:n})}},{key:"changeQuantity",value:function(e){this.setState({quantity:e.target.value})}},{key:"addIngredientsRecipe",value:function(e){var t=this.state.item;if(!(t.recipe.find((function(t){return t.id===e.id}))||this.state.quantity<1)){e.quantity=this.state.quantity,t.recipe.push(e);var n=t.recipe.reduce((function(e,t){return e+Number(t.quantity)}),0)/100;t.recipe.map((function(e){return e.percent=(e.quantity/n).toFixed(2)}));var i=t.recipe.reduce((function(e,t){return e+Number(t.quantity)}),0);this.setState({recipe:t,quantity:"",total:i})}}},{key:"deleteIngredientsRecipe",value:function(e){var t=this.state.item,n=t.recipe.filter((function(t){return t.id!==e}));t.recipe=n;var i=t.recipe.reduce((function(e,t){return e+Number(t.quantity)}),0)/100;t.recipe.map((function(e){return e.percent=(e.quantity/i).toFixed(2)}));var a=t.recipe.reduce((function(e,t){return e+Number(t.quantity)}),0);this.setState({recipe:n,total:a})}},{key:"changeTab",value:function(e,t){this.setState({ItemTab:t})}},{key:"onClose",value:function(){this.setState({item:null,ItemTab:"2",quantity:"",total:""}),this.props.onClose()}},{key:"render",value:function(){return h.createElement(P.Z,{open:this.props.open,fullWidth:!0,maxWidth:"lg",onClose:this.onClose.bind(this)},h.createElement(D.Z,null,this.props.method),h.createElement(N.Z,{style:{paddingBottom:10,paddingTop:10}},h.createElement(p.ZP,{container:!0,spacing:3},h.createElement(p.ZP,{item:!0,xs:12},h.createElement(w.ZP,{value:this.state.ItemTab},h.createElement(Z.Z,{sx:{borderBottom:1,borderColor:"divider"}},h.createElement(q.Z,{onChange:this.changeTab.bind(this),variant:"fullWidth"},h.createElement(I.Z,{label:"Дата обновления",value:"1"}),h.createElement(I.Z,{label:"Текущая",value:"2"}),h.createElement(I.Z,{label:"Добавить",value:"3"}))),h.createElement(C.Z,{value:"1"},h.createElement(p.ZP,{container:!0,spacing:3,mb:2},h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(T.Qe,{label:"Дата обновления"})))),h.createElement(C.Z,{value:"2"},h.createElement(A,{method:this.props.method,event:this.state.item,changeItem:this.changeItem.bind(this),changeItemChecked:this.changeItemChecked.bind(this),addIngredientsRecipe:this.addIngredientsRecipe.bind(this),changeQuantity:this.changeQuantity.bind(this),deleteIngredientsRecipe:this.deleteIngredientsRecipe.bind(this),total:this.state.total})),h.createElement(C.Z,{value:"3"},h.createElement(p.ZP,{container:!0,spacing:3,mb:2},h.createElement(p.ZP,{item:!0,xs:12,sm:4},h.createElement(T.Qe,{label:"Дата обновления"}))),h.createElement(A,{method:this.props.method,event:this.state.item,changeItem:this.changeItem.bind(this),changeItemChecked:this.changeItemChecked.bind(this),addIngredientsRecipe:this.addIngredientsRecipe.bind(this),changeQuantity:this.changeQuantity.bind(this),deleteIngredientsRecipe:this.deleteIngredientsRecipe.bind(this),total:this.state.total})))))),h.createElement(R.Z,null,h.createElement(f.Z,{onClick:this.props.save.bind(this,this.state.item),color:"primary"},"Сохранить")))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.event&&e.event!==t.event?{item:e.event}:null}}]),n}(h.Component),W=function(e){(0,m.Z)(n,e);var t=U(n);function n(){return(0,l.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"shouldComponentUpdate",value:function(e){return!0}},{key:"render",value:function(){var e=this;return h.createElement(y.Z,null,h.createElement(z.Z,null,h.createElement(k.Z,null,h.createElement(b.Z,{style:{width:"2%"}},"#"),h.createElement(b.Z,{style:{width:"2%"}}),h.createElement(b.Z,{style:{width:"3%"}},"Ревизия"),h.createElement(b.Z,{style:{width:"30%"}},"Название"),h.createElement(b.Z,{style:{width:"65%"}},"Место хранения"))),h.createElement(g.Z,null,this.props.recipes.map((function(t,n){return h.createElement(k.Z,{key:n},h.createElement(b.Z,null,t.id),h.createElement(b.Z,null,1==parseInt(t.is_show)?h.createElement(E.Z,null):h.createElement(_.Z,null)),h.createElement(b.Z,null,h.createElement(T.IA,{label:"",value:1==parseInt(t.show_in_rev)})),h.createElement(b.Z,{style:{cursor:"pointer"},onClick:e.props.openModalRecipes.bind(e,"Редактирование рецепта",t.id)},t.name),h.createElement(b.Z,null,t.location[0]))}))))}}]),n}(h.Component),j=function(e){(0,m.Z)(d,e);var t,n,c,o=U(d);function d(e){var t;return(0,l.Z)(this,d),t=o.call(this,e),(0,r.Z)((0,a.Z)(t),"getData",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:F.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e)}))})),t.state={module:"recept_module",module_name:"",is_load:!1,item:{allRecipes:[{id:"1",is_show:1,show_in_rev:0,name:"Паста вареная",location:["Кухня Пицца"],time_stagе:"10:00",term:"72 часа",post:{id:"2",name:"Повар"},recipe:[{id:"1",name:"7Up 0.6 л",ed_izmer:"гр",quantity:10},{id:"2",name:"Бахилы полиэтиленовые",ed_izmer:"шт",quantity:5}],pf_list:[{id:"1",name:"7Up 0.6 л",ed_izmer:"гр"},{id:"2",name:"Бахилы полиэтиленовые",ed_izmer:"шт"},{id:"3",name:"Васаби 5г.",ed_izmer:"шт"},{id:"4",name:"Вилка черная, одноразовая",ed_izmer:"шт"},{id:"6",name:"Aqua Minerale Не газ.",ed_izmer:"кг"},{id:"7",name:"Губка металлическая",ed_izmer:"шт"},{id:"8",name:"Губки для посуды",ed_izmer:"шт"},{id:"9",name:"Зиплок 10*100",ed_izmer:"шт"},{id:"10",name:"Икра масаго красная",ed_izmer:"гр"},{id:"11",name:"Имбирь 30 г.",ed_izmer:"шт"}]},{id:"3",is_show:1,show_in_rev:0,name:"Кляр",location:["Стеллаж"],time_stagе:"15:00",term:"30 часов",post:{id:"3",name:"Кухонный работник"},recipe:[{iid:"7",name:"Губка металлическая",ed_izmer:"шт",quantity:10},{id:"2",name:"Бахилы полиэтиленовые",ed_izmer:"шт",quantity:5}],pf_list:[{id:"1",name:"7Up 0.6 л",ed_izmer:"гр"},{id:"2",name:"Бахилы полиэтиленовые",ed_izmer:"шт"},{id:"3",name:"Васаби 5г.",ed_izmer:"шт"},{id:"4",name:"Вилка черная, одноразовая",ed_izmer:"шт"},{id:"6",name:"Aqua Minerale Не газ.",ed_izmer:"кг"},{id:"7",name:"Губка металлическая",ed_izmer:"шт"},{id:"8",name:"Губки для посуды",ed_izmer:"шт"},{id:"9",name:"Зиплок 10*100",ed_izmer:"шт"},{id:"10",name:"Икра масаго красная",ed_izmer:"гр"},{id:"11",name:"Имбирь 30 г.",ed_izmer:"шт"}]},{id:"4",is_show:0,show_in_rev:1,name:"Лососевый замес",location:["Холодильник"],time_stagе:"20:00",term:"15 часов",post:{id:"2",name:"Повар"},recipe:[{id:"1",name:"7Up 0.6 л",ed_izmer:"гр",quantity:10},{id:"4",name:"Вилка черная, одноразовая",ed_izmer:"шт",quantity:5}],pf_list:[{id:"1",name:"7Up 0.6 л",ed_izmer:"гр"},{id:"2",name:"Бахилы полиэтиленовые",ed_izmer:"шт"},{id:"3",name:"Васаби 5г.",ed_izmer:"шт"},{id:"4",name:"Вилка черная, одноразовая",ed_izmer:"шт"},{id:"6",name:"Aqua Minerale Не газ.",ed_izmer:"кг"},{id:"7",name:"Губка металлическая",ed_izmer:"шт"},{id:"8",name:"Губки для посуды",ed_izmer:"шт"},{id:"9",name:"Зиплок 10*100",ed_izmer:"шт"},{id:"10",name:"Икра масаго красная",ed_izmer:"гр"},{id:"11",name:"Имбирь 30 г.",ed_izmer:"шт"}]},{id:"5",is_show:1,show_in_rev:0,name:"Соус Спайси",location:["Холодильник"],time_stagе:"11:00",term:"50 часов",post:{id:"3",name:"Кухонный работник"},recipe:[{id:"1",name:"7Up 0.6 л",ed_izmer:"гр",quantity:10},{id:"3",name:"Васаби 5г.",ed_izmer:"шт",quantity:5}],pf_list:[{id:"1",name:"7Up 0.6 л",ed_izmer:"гр"},{id:"2",name:"Бахилы полиэтиленовые",ed_izmer:"шт"},{id:"3",name:"Васаби 5г.",ed_izmer:"шт"},{id:"4",name:"Вилка черная, одноразовая",ed_izmer:"шт"},{id:"6",name:"Aqua Minerale Не газ.",ed_izmer:"кг"},{id:"7",name:"Губка металлическая",ed_izmer:"шт"},{id:"8",name:"Губки для посуды",ed_izmer:"шт"},{id:"9",name:"Зиплок 10*100",ed_izmer:"шт"},{id:"10",name:"Икра масаго красная",ed_izmer:"гр"},{id:"11",name:"Имбирь 30 г.",ed_izmer:"шт"}]}]},modalDialogNew:!1,modalDialogEdit:!1,method:null,itemNew:{name:"",time_stagе:"00:00",term:"",recipe:[],location:[{id:"1",name:"Стеллаж"},{id:"2",name:"Холодильник"},{id:"3",name:"Кухня Роллы"}],post:[{id:"1",name:"Не требуется"},{id:"2",name:"Повар"},{id:"3",name:"Кухонный работник"}],pf_list:[{id:"1",name:"7Up 0.6 л",ed_izmer:"гр"},{id:"2",name:"Бахилы полиэтиленовые",ed_izmer:"шт"},{id:"3",name:"Васаби 5г.",ed_izmer:"шт"},{id:"4",name:"Вилка черная, одноразовая",ed_izmer:"шт"},{id:"6",name:"Aqua Minerale Не газ.",ed_izmer:"кг"},{id:"7",name:"Губка металлическая",ed_izmer:"шт"},{id:"8",name:"Губки для посуды",ed_izmer:"шт"},{id:"9",name:"Зиплок 10*100",ed_izmer:"шт"},{id:"10",name:"Икра масаго красная",ed_izmer:"гр"},{id:"11",name:"Имбирь 30 г.",ed_izmer:"шт"}]},recipes:null},t}return(0,s.Z)(d,[{key:"componentDidMount",value:(c=(0,i.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_all");case 2:t=e.sent,this.setState({module_name:t.module_info.name}),document.title=t.module_info.name;case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"openModalRecipes",value:function(e,t){if("Новый рецепт"===e)this.setState({modalDialogNew:!0,method:e});else{var n=this.state.item.allRecipes.find((function(e){return e.id===t}));this.setState({modalDialogEdit:!0,method:e,recipes:n})}}},{key:"saveNewItem",value:(n=(0,i.Z)(u().mark((function e(t,n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({modalDialogNew:!1});case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"saveEditItem",value:(t=(0,i.Z)(u().mark((function e(t,n){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({modalDialogEdit:!1});case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return h.createElement(h.Fragment,null,h.createElement(M.Z,{style:{zIndex:99},open:this.state.is_load},h.createElement(Q.Z,{color:"inherit"})),h.createElement(p.ZP,{container:!0,spacing:3},h.createElement(p.ZP,{item:!0,xs:12,sm:12},h.createElement("h1",null,this.state.module_name)),h.createElement(p.ZP,{item:!0,xs:12,sm:3,mb:3},h.createElement(f.Z,{onClick:this.openModalRecipes.bind(this,"Новый рецепт"),variant:"contained"},"Добавить рецепт"))),h.createElement(V,{open:this.state.modalDialogNew,onClose:function(){e.setState({modalDialogNew:!1})},method:this.state.method,event:this.state.itemNew,save:this.saveNewItem.bind(this)}),h.createElement(B,{open:this.state.modalDialogEdit,onClose:function(){e.setState({modalDialogEdit:!1})},method:this.state.method,event:this.state.recipes,save:this.saveEditItem.bind(this)}),h.createElement(p.ZP,{item:!0,xs:12},h.createElement(W,{recipes:this.state.item.allRecipes,openModalRecipes:this.openModalRecipes.bind(this)})))}}]),d}(h.Component);function O(){return h.createElement(j,null)}},2734:(e,t,n)=>{var i=n(4783)(e.id,{locals:!1});e.hot.dispose(i),e.hot.accept(void 0,i)}}]);
//# sourceMappingURL=316.104418d0de5e7a0f99c5.js.map