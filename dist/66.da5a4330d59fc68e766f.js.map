{"version":3,"file":"66.da5a4330d59fc68e766f.js","mappings":"8JAiTO,SAASA,IACd,OACE,gCAEH,C,QApSmBC,EAAQ,K,iBCbtB,IAAIC,EAAY,EAAQ,KAAR,CAA0FC,EAAOC,GAAI,CAAC,QAAS,IAC/HD,EAAOE,IAAIC,QAAQJ,GACnBC,EAAOE,IAAIE,YAAOC,EAAWN,E","sources":["webpack://package.json/./src/components/tender/tender.component.jsx","webpack://package.json/./src/components/tender/tender.style.scss?9070"],"sourcesContent":["import React from 'react';\r\n\r\nimport Grid from '@mui/material/Grid';\r\nimport Button from '@mui/material/Button';\r\n\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\n\r\nimport Backdrop from '@mui/material/Backdrop';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\n\r\nimport { MyAutocomplite } from '../../stores/elements';\r\n\r\n//import {AgGridColumn, AgGridReact} from 'ag-grid-react';\r\n\r\nconst queryString = require('query-string');\r\n\r\n/*\r\nconst dynamicCellStyle = params => {\r\n  if( params.colDef.headerName == 'Цена' ){\r\n    return { borderRight: '1px solid #bababa' };\r\n  }\r\n  return null;\r\n};\r\n\r\nclass Tender_ extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n        \r\n    this.state = {\r\n      module: 'tender',\r\n      module_name: '',\r\n      is_load: false,\r\n      \r\n      modalDialog: false,\r\n      \r\n      testTable: [],\r\n      vendors: [],\r\n      myVendors: [],\r\n      showVendors: [],\r\n      \r\n      params_api: null,\r\n      params_columnApi: null\r\n    };\r\n  }\r\n  \r\n  async componentDidMount(){\r\n    let data = await this.getData('get_all');\r\n    \r\n    let table = [];\r\n    \r\n    data.items.map( (main_cat, k1) => {\r\n      \r\n      table.push({\r\n        section: 'big-title',\r\n        item: main_cat.name\r\n      })\r\n      \r\n      main_cat.cats.map( (cat, k2) => {\r\n        table.push({\r\n          section: 'big-title',\r\n          item: cat.name\r\n        })\r\n        \r\n        cat.items.map( (item, k3) => {\r\n          let tableItem = {};\r\n          \r\n          data['vendors'].map( (it, k4) => {\r\n            \r\n            let item_price = data.vendor_price.find( (item_price) => parseInt(item_price.vendor_id) == parseInt(it['id']) && parseInt(item_price.item_id) == parseInt(item['id']) );\r\n            \r\n            \r\n            if( item_price ){\r\n              tableItem[ 'vend_price_'+it['id'] ] = item_price['price'];  \r\n              tableItem[ 'vend_city_'+it['id'] ] = 'тлт';\r\n            }else{\r\n              tableItem[ 'vend_price_'+it['id'] ] = '';  \r\n              tableItem[ 'vend_city_'+it['id'] ] = '';\r\n            }\r\n            \r\n          } )\r\n          tableItem.item = item.name;\r\n          tableItem.section = 'last';\r\n          \r\n          let item_ras = data.ras.find( (item_ras) => parseInt(item_ras.item_id) == parseInt(item['id']) );\r\n          \r\n          if( item_ras ){\r\n            tableItem.ras = item_ras.count_pf;\r\n          }else{\r\n            tableItem.ras = '';\r\n          }\r\n          \r\n          table.push(tableItem)\r\n        } )\r\n      } )\r\n    } )\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    this.setState({\r\n      module_name: data.module_info.name,\r\n      testTable: table,\r\n      vendors: data['vendors'],\r\n      showVendors: data['vendors']\r\n    })\r\n    \r\n    document.title = data.module_info.name;\r\n  }\r\n  \r\n  getData = (method, data = {}) => {\r\n    \r\n    this.setState({\r\n      is_load: true\r\n    })\r\n    \r\n    return fetch('https://jacochef.ru/api/index_new.php', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type':'application/x-www-form-urlencoded'},\r\n      body: queryString.stringify({\r\n        method: method, \r\n        module: this.state.module,\r\n        version: 2,\r\n        login: localStorage.getItem('token'),\r\n        data: JSON.stringify( data )\r\n      })\r\n    }).then(res => res.json()).then(json => {\r\n      \r\n      if( json.st === false && json.type == 'redir' ){\r\n        window.location.pathname = '/';\r\n        return;\r\n      }\r\n      \r\n      if( json.st === false && json.type == 'auth' ){\r\n        window.location.pathname = '/auth';\r\n        return;\r\n      }\r\n      \r\n      setTimeout( () => {\r\n        this.setState({\r\n          is_load: false\r\n        })\r\n      }, 300 )\r\n      \r\n      return json;\r\n    })\r\n    .catch(err => { \r\n      console.log( err )\r\n      this.setState({\r\n        is_load: false\r\n      })\r\n    });\r\n  }\r\n  \r\n  onCellClicked(event){\r\n    console.log( event.data );\r\n    console.log( event.colDef.field );\r\n  }\r\n  \r\n  onGridReady(params){\r\n    this.setState({\r\n      params_api: params.api,\r\n      params_columnApi: params.columnApi\r\n    });\r\n  }\r\n  \r\n  async show(){\r\n    let data = {\r\n      vendors: this.state.myVendors\r\n    };\r\n    \r\n    let res = await this.getData('get_data', data);\r\n    \r\n    let table = [];\r\n    \r\n    res.items.map( (main_cat, k1) => {\r\n      \r\n      table.push({\r\n        section: 'big-title',\r\n        item: main_cat.name\r\n      })\r\n      \r\n      main_cat.cats.map( (cat, k2) => {\r\n        table.push({\r\n          section: 'big-title',\r\n          item: cat.name\r\n        })\r\n        \r\n        cat.items.map( (item, k3) => {\r\n          let tableItem = {};\r\n          \r\n          res['vendors'].map( (it, k4) => {\r\n            \r\n            let item_price = res.vendor_price.find( (item_price) => parseInt(item_price.vendor_id) == parseInt(it['id']) && parseInt(item_price.item_id) == parseInt(item['id']) )\r\n            \r\n            if( item_price ){\r\n              tableItem[ 'vend_price_'+it['id'] ] = item_price['price'];  \r\n              tableItem[ 'vend_city_'+it['id'] ] = 'тлт';\r\n            }else{\r\n              tableItem[ 'vend_price_'+it['id'] ] = '';  \r\n              tableItem[ 'vend_city_'+it['id'] ] = '';\r\n            }\r\n            \r\n          } )\r\n          tableItem.item = item.name;\r\n          tableItem.section = 'last';\r\n          \r\n          let item_ras = res.ras.find( (item_ras) => parseInt(item_ras.item_id) == parseInt(item['id']) );\r\n          \r\n          if( item_ras ){\r\n            tableItem.ras = item_ras.count_pf;\r\n          }else{\r\n            tableItem.ras = '';\r\n          }\r\n          \r\n          table.push(tableItem)\r\n        } )\r\n      } )\r\n    } )\r\n    \r\n    \r\n    \r\n    \r\n    \r\n    \r\n    this.setState({\r\n      testTable: table,\r\n      showVendors: res['vendors']\r\n    })\r\n  }\r\n  \r\n  render(){\r\n    return (\r\n      <>\r\n        <Backdrop open={this.state.is_load}>\r\n          <CircularProgress color=\"inherit\" />\r\n        </Backdrop>\r\n        \r\n        <Dialog\r\n          open={this.state.modalDialog}\r\n          onClose={ () => { this.setState({ modalDialog: false }) } }\r\n          aria-labelledby=\"alert-dialog-title\"\r\n          aria-describedby=\"alert-dialog-description\"\r\n        >\r\n          <DialogTitle id=\"alert-dialog-title\">Новая категория</DialogTitle>\r\n          <DialogContent>\r\n            \r\n            \r\n            \r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button  color=\"primary\">Сохранить</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n        \r\n        <Grid container spacing={3}>\r\n          <Grid item xs={12} sm={12}>\r\n            <h1>{this.state.module_name}</h1>\r\n          </Grid>\r\n          \r\n          <Grid item xs={12} sm={12}>\r\n            <MyAutocomplite data={this.state.vendors} multiple={true} value={this.state.myVendors} func={ (event, val) => { this.setState({ myVendors: val }) } } label='Поставщики' />\r\n          </Grid>\r\n          <Grid item xs={12} sm={3}>\r\n            <Button variant=\"contained\" onClick={this.show.bind(this)}>Показать</Button>\r\n          </Grid>\r\n          \r\n          <Grid item xs={12}>\r\n            <div className=\"ag-theme-alpine\" style={{height: 600, width: '100%'}}>\r\n              <AgGridReact\r\n                  onGridReady={this.onGridReady.bind(this)}\r\n                  onCellClicked={this.onCellClicked}\r\n                  rowData={ this.state.testTable }\r\n                  \r\n                  >\r\n                  <AgGridColumn field=\"ras\" width={120} pinned=\"left\"></AgGridColumn>\r\n                  <AgGridColumn field=\"item\" width={300} pinned=\"left\" cellClassRules={{'cell-span': \"data.section==='big-title'\"}}></AgGridColumn>\r\n                  <AgGridColumn hide={true}></AgGridColumn>\r\n                    \r\n                  { this.state.showVendors.map( (item, key) => \r\n                    <AgGridColumn key={key} headerName={item.name} resizable={true} width={180}>\r\n                      <AgGridColumn field={'vend_city_'+item.id} headerName={'Город'} resizable={true} width={90}></AgGridColumn>\r\n                      <AgGridColumn field={'vend_price_'+item.id} headerName={'Цена'} resizable={true} width={90} cellStyle={dynamicCellStyle}></AgGridColumn>\r\n                    </AgGridColumn>\r\n                  ) }\r\n                  \r\n                  \r\n              </AgGridReact>\r\n            </div>\r\n          </Grid>\r\n          \r\n          <Grid item xs={12} sm={12}>\r\n          \r\n          </Grid>    \r\n        </Grid>\r\n      </>\r\n    )\r\n  }\r\n}*/\r\n\r\nexport function Tender() {\r\n  return (\r\n    <></>\r\n  );\r\n}","// extracted by mini-css-extract-plugin\nexport {};\n    if(module.hot) {\n      // 1662986116111\n      var cssReload = require(\"../../../node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"names":["Tender","require","cssReload","module","id","hot","dispose","accept","undefined"],"sourceRoot":""}