"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[847],{7847:(e,t,n)=>{n.r(t),n.d(t,{default:()=>O}),n(312);var a=n(5861),i=n(5671),s=n(3144),l=n(7326),r=n(136),o=n(6215),m=n(1120),c=n(4942),u=n(7462),d=(n(5987),n(4687)),h=n.n(d),p=n(7294),f=n(5725),Z=n(4567),E=n(9062),_=n(4666),g=n(7750),w=n(7645),v=n(9573),k=n(8732),y=n(6926),b=n(6011),x=n(3694),I=n(6501),S=n(5697),P=n.n(S),T=n(20),D=n(2640),W=(n(1508),n(2658)),C=n(6406);var R=n(7563);function j(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}P().node,P().number.isRequired,P().number.isRequired;var N=function(e){(0,r.Z)(O,e);var t,n,d,S,P,N=(S=O,P=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,m.Z)(S);if(P){var n=(0,m.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,o.Z)(this,e)});function O(e){var t;return(0,i.Z)(this,O),t=N.call(this,e),(0,c.Z)((0,l.Z)(t),"getData",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:R.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e),t.setState({is_load:!1})}))})),t.state={module:"app_work_show",module_name:"",is_load:!1,items:[],items_min:[],showItems:[],modalDialog:!1,modalDialogNew:!1,activeTab:0,dows:[{id:1,name:"Понедельник"},{id:2,name:"Вторник"},{id:3,name:"Среда"},{id:4,name:"Четверг"},{id:5,name:"Пятница"},{id:6,name:"Суббота"},{id:7,name:"Воскресенье"},{id:10,name:"Другое"},{id:11,name:"Каждый день"},{id:12,name:"Каждый день в конце смены"},{id:13,name:"Ручное добавление"},{id:14,name:"После выполнение уборки"}],types:[{id:0,name:"Другое"},{id:1,name:"Только 1 активная"},{id:2,name:"Добавление без ограничений"}],itemsEdit:null,nameWork:"",itemsNew:null,chengeItem1:null,chengeItemNew1:null,points:[],point_id:""},t}return(0,s.Z)(O,[{key:"componentDidMount",value:(d=(0,a.Z)(h().mark((function e(){var t,n=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_points");case 2:t=e.sent,this.setState({points:t,point_id:t[0].id}),setTimeout((function(){n.getWorks()}),300);case 5:case"end":return e.stop()}}),e,this)}))),function(){return d.apply(this,arguments)})},{key:"getWorks",value:(n=(0,a.Z)(h().mark((function e(){var t,n,a,i=this;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={point_id:this.state.point_id},e.next=3,this.getData("get_all",t);case 3:(n=e.sent).items.map((function(e,t){n.items[t].dow_name=i.state.dows.find((function(t){return parseInt(t.id)==parseInt(e.dow)})).name})),0==(a=parseInt(this.state.activeTab))&&(a=5),1==a&&(a=6),2==a&&(a=21),this.setState({module_name:n.module_info.name,items:n.items,showItems:n.items.filter((function(e){return parseInt(e.app_id)==parseInt(a)})),items_min:n.items_min}),document.title=n.module_info.name;case 11:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"openWork",value:(t=(0,a.Z)(h().mark((function e(t){var n,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:t,point_id:this.state.point_id},e.next=3,this.getData("get_one",n);case 3:a=e.sent,console.log(a),this.setState({itemsEdit:a,modalDialog:!0});case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"changeTab",value:function(e,t){var n=parseInt(t);0==t&&(n=5),1==t&&(n=6),2==t&&(n=21),this.setState({activeTab:t,showItems:this.state.items.filter((function(e){return parseInt(e.app_id)==parseInt(n)}))})}},{key:"render",value:function(){var e=this;return p.createElement(p.Fragment,null,p.createElement(Z.Z,{style:{zIndex:99},open:this.state.is_load},p.createElement(E.Z,{color:"inherit"})),p.createElement(f.ZP,{container:!0,spacing:3},p.createElement(f.ZP,{item:!0,xs:12,sm:12},p.createElement("h1",null,this.state.module_name)),p.createElement(f.ZP,{item:!0,xs:12,sm:3},p.createElement(C.$S,{data:this.state.points,value:this.state.point_id,func:function(t){e.setState({point_id:t.target.value})},label:"Точка"})),this.state.itemsEdit?p.createElement(_.Z,{open:this.state.modalDialog,maxWidth:"md",onClose:function(){e.setState({modalDialog:!1,itemsEdit:null,nameWork:""})}},p.createElement(w.Z,null,'Уборка "',this.state.itemsEdit.item.name,'"'),p.createElement(g.Z,null,p.createElement(f.ZP,{container:!0,spacing:0},p.createElement(f.ZP,{item:!0,xs:12},p.createElement(W.Z,null,this.state.itemsEdit.item.cat_name)),0==this.state.itemsEdit.item.show_time?null:p.createElement(f.ZP,{item:!0,xs:12},p.createElement(W.Z,null,"Время за уборку: ",this.state.itemsEdit.item.time_min," мин.")),p.createElement(f.ZP,{item:!0,xs:12},p.createElement(W.Z,null,"Описание процесса уборки: ")),p.createElement(f.ZP,{item:!0,xs:12},p.createElement(W.Z,{dangerouslySetInnerHTML:{__html:this.state.itemsEdit.item.text_work}}))))):null,p.createElement(f.ZP,{item:!0,xs:12,sm:12},p.createElement(I.Z,null,p.createElement(T.Z,{value:this.state.activeTab,onChange:this.changeTab.bind(this)},p.createElement(D.Z,(0,u.Z)({label:"Повар"},j(0))),p.createElement(D.Z,(0,u.Z)({label:"Кассир"},j(1))),p.createElement(D.Z,(0,u.Z)({label:"Кухонный работник"},j(2)))))),p.createElement(f.ZP,{item:!0,xs:12,sm:12},p.createElement(v.Z,null,p.createElement(b.Z,null,p.createElement(x.Z,null,p.createElement(y.Z,null,"Работа"),p.createElement(y.Z,null,"День недели"),p.createElement(y.Z,null,"Время открытия"),p.createElement(y.Z,null,"Время автоматического удаления"))),p.createElement(k.Z,null,this.state.showItems.map((function(t,n){return p.createElement(x.Z,{key:n},p.createElement(y.Z,{onClick:e.openWork.bind(e,t.id),style:{color:"#c03",cursor:"pointer",fontWeight:"bold"}},t.work_name),p.createElement(y.Z,null,t.dow_name," ",t.need_work_name),p.createElement(y.Z,null,t.times_open),p.createElement(y.Z,null,t.times_close))})))))))}}]),O}(p.Component);function O(){return p.createElement(N,null)}},312:(e,t,n)=>{var a=n(4783)(e.id,{locals:!1});e.hot.dispose(a),e.hot.accept(void 0,a)}}]);
//# sourceMappingURL=847.6b5a492458cf866cc209.js.map