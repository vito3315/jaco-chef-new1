"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[187],{1187:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F}),n(9944);var a=n(2982),s=n(5861),l=n(4942),i=n(5671),o=n(3144),r=n(7326),m=n(136),u=n(6215),c=n(1120),p=n(4687),h=n.n(p),d=n(7294),f=n(30),Z=n(1822),v=n(4373),E=n(130),y=n(3150),N=n(6140),g=n(3030),S=n(8561),w=n(8736),k=n(6540),b=n(594),_=n(9620),P=n(2962),C=n(4498),x=n(7745),D=n(3892),j=n(5705),M=n(6406);function R(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,c.Z)(e);if(t){var s=(0,c.Z)(this).constructor;n=Reflect.construct(a,arguments,s)}else n=a.apply(this,arguments);return(0,u.Z)(this,n)}}var I=n(7563),z=function(e){(0,m.Z)(n,e);var t=R(n);function n(e){var a;return(0,i.Z)(this,n),(a=t.call(this,e)).handleResize=a.handleResize.bind((0,r.Z)(a)),a.state={item:[],point:-1,newSmena:[],smena:[],name:"",smenaName:"",history:[],fullScreen:!1},a}return(0,o.Z)(n,[{key:"componentDidUpdate",value:function(e){this.props.event&&this.props.event!==e.event&&this.setState({item:this.props.event,name:this.props.event.name?this.props.event.name:"",newSmena:"Создание смены"===this.props.method?[]:[this.props.event],smena:"Создание смены"===this.props.method?[]:this.props.editSmena[0].data,smenaName:"Редактирование смены"===this.props.method?this.props.smenaName:"",history:"Редактирование смены"===this.props.method?this.props.event.history:[]})}},{key:"changeItem",value:function(e){this.setState({name:e.target.value})}},{key:"changePoint",value:function(e){var t=this.state.item.filter((function(t){return t.id===e.target.value}));this.setState({point:e.target.value,smena:t[0].data})}},{key:"addEmployeeSmena",value:function(e){var t=this.state.newSmena,n=this.state.smena.filter((function(t){return t.fullName!==e.fullName}));if(this.state.name){if(t.length)t[0].data.push(e);else{var a={id:this.state.point,name:this.state.name,history:[],data:[e]};t.push(a)}this.setState({newSmena:t,smena:n})}else alert("Заполните наименование смены")}},{key:"deleteEmployeeSmena",value:function(e){var t=this.state.newSmena,n=this.state.smena,a=t[0].data.filter((function(t){return t.fullName!==e.fullName}));t[0].data=a,n.push(e),this.setState({smena:n,newSmena:t})}},{key:"save",value:function(){this.props.save(this,this.props.method,this.state.newSmena,this.state.smena,this.state.name),this.setState({item:[],point:-1,newSmena:[],smena:[],name:"",smenaName:""}),this.props.onClose()}},{key:"delete",value:function(){confirm("Вы действительно хотите удалить данную смену?")&&(this.props.delete(this.props.event),this.setState({item:[],point:-1,newSmena:[],smena:[],name:"",smenaName:""}))}},{key:"onClose",value:function(){this.setState({item:this.props.event?this.props.event:[],point:-1,newSmena:"Создание смены"===this.props.method?[]:[this.props.event],smena:"Создание смены"===this.props.method?[]:this.props.editSmena[0].data,name:this.props.event?this.props.event.name:"",smenaName:"Редактирование смены"===this.props.method?this.props.smenaName:"",history:"Редактирование смены"===this.props.method?this.props.event.history:[]}),this.props.onClose()}},{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"handleResize",value:function(){window.innerWidth<601?this.setState({fullScreen:!0}):this.setState({fullScreen:!1})}},{key:"render",value:function(){var e=this;return d.createElement(_.Z,{fullScreen:this.state.fullScreen,open:this.props.open,onClose:this.onClose.bind(this),fullWidth:!0,maxWidth:"lg","aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},d.createElement(x.Z,{disableTypography:!0,className:"dialogTitle"},d.createElement("h4",{style:{fontWeight:"normal"}},this.props.method," ",this.state.smenaName),this.state.fullScreen?d.createElement(E.Z,{onClick:this.onClose.bind(this),style:{cursor:"pointer"}},d.createElement(b.Z,null)):null),d.createElement(C.Z,{style:{paddingBottom:10,paddingTop:10}},"Создание смены"===this.props.method?d.createElement(f.ZP,{container:!0,spacing:3,className:"OpenModalM"},d.createElement(f.ZP,{item:!0,xs:6,sm:6},d.createElement(M.$S,{data:this.props.points,value:this.state.point,func:this.changePoint.bind(this),label:"Точка"})),d.createElement(f.ZP,{item:!0,xs:6,sm:6},d.createElement(M.rZ,{label:"Наименование смены",value:this.state.name,func:this.changeItem.bind(this)}))):d.createElement(f.ZP,{container:!0,spacing:3,className:"OpenModalM"},d.createElement(f.ZP,{item:!0,xs:6,sm:6},d.createElement(M.rZ,{label:"Наименование смены",value:this.state.name,func:this.changeItem.bind(this)}))),d.createElement(f.ZP,{container:!0,spacing:3,mb:3,className:"OpenModalM"},d.createElement(f.ZP,{item:!0,xs:6,sm:6},d.createElement(f.ZP,{mt:3},"Оставшиеся сотрудники"),d.createElement(y.Z,null,d.createElement(S.Z,null,d.createElement(w.Z,null,d.createElement(g.Z,{style:{width:"5%"}},"#"),d.createElement(g.Z,{style:{width:"40%"}},"Ф.И.О."),d.createElement(g.Z,{style:{width:"50%"}},"Должность"),d.createElement(g.Z,{style:{width:"5%"}}))),d.createElement(N.Z,null,this.state.smena.map((function(t,n){return d.createElement(w.Z,{key:n,sx:{"& td":{border:0}}},d.createElement(g.Z,null,n+1),d.createElement(g.Z,null,t.fullName),d.createElement(g.Z,null,t.post),d.createElement(g.Z,null,d.createElement(k.Z,{onClick:e.addEmployeeSmena.bind(e,t),style:{cursor:"pointer"}})))})))),d.createElement(v.Z,null)),d.createElement(f.ZP,{item:!0,xs:6,sm:6},d.createElement(f.ZP,{mt:3},"Сотрудники в смене"),d.createElement(y.Z,null,d.createElement(S.Z,null,d.createElement(w.Z,null,d.createElement(g.Z,{style:{width:"5%"}},"#"),d.createElement(g.Z,{style:{width:"40%"}},"Ф.И.О."),d.createElement(g.Z,{style:{width:"50%"}},"Должность"),d.createElement(g.Z,{style:{width:"5%"}}))),d.createElement(N.Z,null,this.state.newSmena.map((function(t){return t.data.map((function(t,n){return d.createElement(w.Z,{key:n,sx:{"& td":{border:0}}},d.createElement(g.Z,null,n+1),d.createElement(g.Z,null,t.fullName),d.createElement(g.Z,null,t.post),d.createElement(g.Z,null,d.createElement(b.Z,{onClick:e.deleteEmployeeSmena.bind(e,t),style:{cursor:"pointer"}})))}))})))),d.createElement(v.Z,null)))),d.createElement(P.Z,{className:"Редактирование смены"===this.props.method?"dialogTitle":null},"Редактирование смены"===this.props.method?d.createElement(Z.Z,{onClick:this.delete.bind(this),color:"primary"},"Удалить смену"):null,d.createElement(Z.Z,{onClick:this.save.bind(this),style:{color:"#00a550"}},"Сохранить")))}}]),n}(d.Component),T=function(e){(0,m.Z)(n,e);var t=R(n);function n(){return(0,i.Z)(this,n),t.apply(this,arguments)}return(0,o.Z)(n,[{key:"shouldComponentUpdate",value:function(e){var t=e.event,n=this.props.event;return!(t.length==n.length&&t.every((function(e,t){return e===n[t]})))}},{key:"render",value:function(){var e=this;return d.createElement(d.Fragment,null,this.props.event.map((function(t,n){return d.createElement(d.Fragment,{key:n},d.createElement(f.ZP,{style:{cursor:"pointer"},mt:3,onClick:e.props.openModal.bind(e,"Редактирование смены",t)},t.name),d.createElement(y.Z,null,d.createElement(S.Z,null,d.createElement(w.Z,null,d.createElement(g.Z,null,"#"),d.createElement(g.Z,null,"Ф.И.О."),d.createElement(g.Z,null,"Должность"))),d.createElement(N.Z,null,t.data.map((function(e,t){return d.createElement(w.Z,{key:t,sx:{"& td":{border:0}}},d.createElement(g.Z,null,t+1),d.createElement(g.Z,null,e.fullName),d.createElement(g.Z,null,e.post))})))),d.createElement(v.Z,null))})))}}]),n}(d.Component),O=function(e){(0,m.Z)(v,e);var t,n,u,c,p=R(v);function v(e){var t,n,a,s,o,m;return(0,i.Z)(this,v),t=p.call(this,e),(0,l.Z)((0,r.Z)(t),"getData",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:I.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e)}))})),t.state={module:"user_smena",module_name:"",is_load:!1,points:[{id:-1,name:"Выберите точку"},{base:"jaco_rolls_1",name:"Тольятти, Ленинградская 47",id:"1",city_id:"1"},{base:"jaco_rolls_2",name:"Тольятти, Ворошилова 12а",id:"2",city_id:"1"},{base:"jaco_rolls_3",name:"Тольятти, Матросова 32",id:"3",city_id:"1"},{base:"jaco_rolls_6",name:"Тольятти, Цветной 1",id:"6",city_id:"1"},{base:"jaco_rolls_4",name:"Самара, Куйбышева 113",id:"4",city_id:"2"},{base:"jaco_rolls_5",name:"Самара, Победы 10",id:"5",city_id:"2"},{base:"jaco_rolls_7",name:"Самара, Молодёжная 2",id:"7",city_id:"2"}],point:"0",date_update:(n=new Date,a=new Date(n),s=""+(a.getMonth()+1),o=""+a.getDate(),m=a.getFullYear(),s.length<2&&(s="0"+s),o.length<2&&(o="0"+o),[m,s,o].join("-")),shifts:[{id:"1",name:"1 смена",history:[{time:"2019-09-30 14:20:59",fullName:"Волина И.В.",post:"Директор кафе",data:[{fullName:"Папулова И.А.",post:"Менеджер"},{fullName:"Заверюха Д.А.",post:"\tКассир"},{fullName:"Усилова А.А.",post:"Кассир"}]},{time:"2019-09-30 14:20:59",fullName:"Волина И.В.",post:"Директор кафе",data:[{fullName:"Папулова И.А.",post:"Менеджер"},{fullName:"Заверюха Д.А.",post:"\tКассир"},{fullName:"Усилова А.А.",post:"Кассир"}]}],data:[{fullName:"Волина И.В.",post:"Директор кафе"},{fullName:"Мазалова Г.М.",post:"Менеджер"},{fullName:"Пасканная Я.А.",post:"Кассир"},{fullName:"Заверюшка Д.А.",post:"Повар универсал"},{fullName:"Иконников Н.С.",post:"Повар универсал"}]},{id:"1",name:"2 смена",history:[{time:"2019-09-30 14:20:59",fullName:"Волина И.В.",post:"Директор кафе",data:[{fullName:"Папулова И.А.",post:"Менеджер"},{fullName:"Заверюха Д.А.",post:"\tКассир"},{fullName:"Усилова А.А.",post:"Кассир"}]}],data:[{fullName:"Папулова И.А.",post:"Менеджер"},{fullName:"Заверюха Д.А.",post:"\tКассир"},{fullName:"Усилова А.А.",post:"Кассир"},{fullName:"Чихирев А.В.",post:"Повар универсал"},{fullName:"Зяблицкая М.Ю.",post:"Повар универсал"}]},{id:"2",name:"1 смена",history:[{time:"2019-10-18 15:11:00",fullName:"Крючков А.В.",post:"Директор кафе",data:[{fullName:"Савельева С.О.",post:"Кассир"},{fullName:"Коркин Г.А.",post:"Повар универсал"},{fullName:"Иванов Д.И.",post:"Повар универсал"}]}],data:[{fullName:"Крючков А.В.",post:"Директор кафе"},{fullName:"Лапотников Л.В.",post:"Менеджер"},{fullName:"Савельева С.О.",post:"Кассир"},{fullName:"Коркин Г.А.",post:"Повар универсал"},{fullName:"Иванов Д.И.",post:"Повар универсал"}]},{id:"2",name:"2 смена",history:[{time:"2019-10-18 15:11:00",fullName:"Крючков А.В.",post:"Директор кафе",data:[{fullName:"Савельева С.О.",post:"Кассир"},{fullName:"Коркин Г.А.",post:"Повар универсал"},{fullName:"Иванов Д.И.",post:"Повар универсал"}]}],data:[{fullName:"Кожемякина А.В.",post:"Менеджер"},{fullName:"Абрамова С.Д.",post:"\tКассир"},{fullName:"Тумаева А.С.",post:"Кассир"},{fullName:"Джафарова С.В.",post:"Повар универсал"},{fullName:"\tИлларионова Е.А.",post:"Повар универсал"}]}],remaining:[{id:"1",data:[{fullName:"Трифонов А.А.",post:"Курьер"},{fullName:"Покарев А.Д.",post:"Курьер"},{fullName:"Воробьев Д.А.",post:"Повар стажер"},{fullName:"Заверюшка Д.А.",post:"Повар стажер"},{fullName:"Умерова Э.М.",post:"Кухонный работник стажер"}]},{id:"2",data:[{fullName:"Шекуров М.Ю.",post:"Менеджер"},{fullName:"Козлова А.С.",post:"Кассир стажер"},{fullName:"Савенкова А.С.",post:"Кассир стажер"},{fullName:"Чихирев А.В.",post:"Повар стажер"}]}],event:[],modalDialog:!1,smena:[],editSmena:[],smenaName:""},t}return(0,o.Z)(v,[{key:"componentDidMount",value:(c=(0,s.Z)(h().mark((function e(){var t;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_all");case 2:t=e.sent,this.setState({point:this.state.points[0].id,module_name:t.module_info.name}),document.title=t.module_info.name;case 5:case"end":return e.stop()}}),e,this)}))),function(){return c.apply(this,arguments)})},{key:"changePoint",value:(u=(0,s.Z)(h().mark((function e(t){var n,a,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.target.value,a=this.state.shifts,s=a.filter((function(e){return e.id===n})),this.setState({point:n,smena:s});case 4:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"openModal",value:function(e,t){if("Создание смены"===e&&this.setState({modalDialog:!0,method:e,event:this.state.remaining}),"Редактирование смены"===e){var n=this.state.remaining.filter((function(e){return e.id===t.id}));this.setState({modalDialog:!0,method:e,smenaName:t.name,editSmena:n,event:t})}}},{key:"saveItem",value:(n=(0,s.Z)(h().mark((function e(t,n,a,s,l){var i,o,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.state.remaining,o=this.state.shifts,r=i.map((function(e){return e.id===a[0].id&&(e.data=s),e})),a[0].name=l,o.push(a[0]),this.setState({modalDialog:!1,remaining:r,shifts:o,point:-1,smena:[]});case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,a,s,l){return n.apply(this,arguments)})},{key:"deleteItem",value:(t=(0,s.Z)(h().mark((function e(t){var n,s,l,i;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state.remaining,s=this.state.shifts,l=n.map((function(e){return e.id===t.id&&(e.data=[].concat((0,a.Z)(e.data),(0,a.Z)(t.data))),e})),i=s.filter((function(e){return e.id!==t.id||e.name!==t.name})),this.setState({modalDialog:!1,remaining:l,shifts:i,point:-1,smena:[]});case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;return d.createElement(d.Fragment,null,d.createElement(D.Z,{style:{zIndex:99},open:this.state.is_load},d.createElement(j.Z,{color:"inherit"})),d.createElement(f.ZP,{container:!0,spacing:3,mb:2},d.createElement(f.ZP,{item:!0,xs:12,sm:12},d.createElement("h1",null,this.state.module_name))),d.createElement(f.ZP,{container:!0,spacing:3,justifyContent:"center"},d.createElement(f.ZP,{item:!0,xs:6,sm:4},d.createElement(M.$S,{data:this.state.points,value:this.state.point,func:this.changePoint.bind(this),label:"Точка"})),d.createElement(f.ZP,{item:!0,xs:6,sm:2},d.createElement(Z.Z,{variant:"contained",style:{whiteSpace:"nowrap"},onClick:this.openModal.bind(this,"Создание смены")},"Добавить смену"))),d.createElement(f.ZP,{container:!0,spacing:3,justifyContent:"center"},d.createElement(f.ZP,{item:!0,xs:12,sm:6},d.createElement(T,{event:this.state.smena,openModal:this.openModal.bind(this)}))),d.createElement(z,{open:this.state.modalDialog,onClose:function(){e.setState({modalDialog:!1})},method:this.state.method,event:this.state.event,points:this.state.points,delete:this.deleteItem.bind(this),save:this.saveItem.bind(this),editSmena:this.state.editSmena,smenaName:this.state.smenaName}))}}]),v}(d.Component);function F(){return d.createElement(O,null)}},9944:(e,t,n)=>{var a=n(4783)(e.id,{locals:!1});e.hot.dispose(a),e.hot.accept(void 0,a)}}]);
//# sourceMappingURL=187.6db3bc0afb6df9acbbb7.js.map