"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[307],{7307:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M}),n(7122);var a=n(5861),l=n(5671),s=n(3144),r=n(7326),i=n(136),c=n(6215),m=n(1120),u=n(4942),o=n(4687),d=n.n(o),h=n(7294),Z=n(5725),E=n(2642),p=n(9573),_=n(8732),f=n(6926),g=n(7896),y=n(6011),w=n(3694),v=n(6501),b=n(9941),I=n(7425),k=n(5092),x=n(3508),D=n(4666),P=n(8979),S=n(7750),L=n(6408),C=n(7645),R=n(4567),F=n(9062),j=n(6406),z=n(2658);var O=n(7563);function T(e){var t=new Date(e),n=""+(t.getMonth()+1),a=""+t.getDate(),l=t.getFullYear();return n.length<2&&(n="0"+n),a.length<2&&(a="0"+a),[l,n,a].join("-")}var B=function(e){(0,i.Z)($,e);var t,n,o,B,M,Q=(B=$,M=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,m.Z)(B);if(M){var n=(0,m.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function $(e){var t;return(0,l.Z)(this,$),t=Q.call(this,e),(0,u.Z)((0,r.Z)(t),"getData",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:O.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/"})).catch((function(e){console.log(e),t.setState({is_load:!1})}))})),t.state={module:"ras_by_bill",module_name:"",is_load:!1,modalDialog:!1,points:[],point:[],date_start:T(new Date),date_end:T(new Date),rangeDate:[T(new Date),T(new Date)],items:[],cats:[],items_cat:[],item_cat:0,myItems:[],calendar:[]},t}return(0,s.Z)($,[{key:"componentDidMount",value:(o=(0,a.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_all");case 2:t=e.sent,this.setState({module_name:t.module_info.name,points:t.points,items:t.items,cats:t.cats,items_cat:t.items_cat}),document.title=t.module_info.name;case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"changePoint",value:function(e){var t=e.target.value;this.setState({point:t})}},{key:"changeItems",value:function(e,t){this.setState({myItems:t})}},{key:"getItems",value:(n=(0,a.Z)(d().mark((function e(){var t,n,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={points:this.state.point,items:this.state.myItems,item_cat:this.state.item_cat,start_date:this.state.date_start,end_date:this.state.date_end},e.next=3,this.getData("get_this_rev",t);case 3:n=e.sent,a=0,n.items_ras.map((function(e,t){a+=parseFloat(e.sum)})),this.setState({resItems:{items_ras:n.items_ras,pf_ras:n.pf_ras,rec_ras:n.rec_ras,full_sum:a.toFixed(2)},catItems:null});case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getCats",value:(t=(0,a.Z)(d().mark((function e(){var t,n,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={points:this.state.point,items:this.state.myItems,start_date:this.state.date_start,end_date:this.state.date_end},e.next=3,this.getData("get_this_rev_cat",t);case 3:n=e.sent,a=0,n.rec_ras.map((function(e,t){a+=parseFloat(e.this_price)})),this.setState({catItems:{count_pos:n.count_pos,items_ras:n.items_ras,rec_ras:n.rec_ras,full_sum:a.toFixed(2)},resItems:null});case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"changeDateRange",value:function(e,t){this.setState((0,u.Z)({},e,T(t)))}},{key:"render",value:function(){var e=this;return h.createElement(h.Fragment,null,h.createElement(R.Z,{style:{zIndex:99},open:this.state.is_load},h.createElement(F.Z,{color:"inherit"})),h.createElement(D.Z,{open:this.state.modalDialog,onClose:function(){e.setState({modalDialog:!1})},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},h.createElement(C.Z,{id:"alert-dialog-title"},"  "),h.createElement(S.Z,null,h.createElement(L.Z,{id:"alert-dialog-description"})),h.createElement(P.Z,null,h.createElement(E.Z,{onClick:function(){},color:"primary"},"Сохранить"))),h.createElement(Z.ZP,{container:!0,spacing:3},h.createElement(Z.ZP,{item:!0,xs:12,sm:12},h.createElement("h1",null,this.state.module_name)),h.createElement(Z.ZP,{item:!0,xs:12,sm:3},h.createElement(j.$S,{data:this.state.points,multiple:!0,value:this.state.point,func:this.changePoint.bind(this),label:"Точка"})),h.createElement(Z.ZP,{item:!0,xs:12,sm:3},h.createElement(j.Qe,{label:"Дата от",value:this.state.date_start,func:this.changeDateRange.bind(this,"date_start")})),h.createElement(Z.ZP,{item:!0,xs:12,sm:3},h.createElement(j.Qe,{label:"Дата до",value:this.state.date_end,func:this.changeDateRange.bind(this,"date_end")})),h.createElement(Z.ZP,{item:!0,xs:12,sm:3},h.createElement(j.$S,{data:this.state.items_cat,multiple:!1,value:this.state.item_cat,func:function(t){e.setState({item_cat:t.target.value})},label:"Категория товара"})),h.createElement(Z.ZP,{item:!0,xs:12,sm:12},h.createElement(j.e_,{data:this.state.items,multiple:!0,value:this.state.myItems,func:this.changeItems.bind(this),label:"Заготовки"})),h.createElement(Z.ZP,{item:!0,xs:12,sm:3},h.createElement(E.Z,{variant:"contained",onClick:this.getItems.bind(this)},"Показать заготовки")),h.createElement(Z.ZP,{item:!0,xs:12,sm:3},h.createElement(E.Z,{variant:"contained",onClick:this.getCats.bind(this)},"Показать категории")),this.state.resItems&&this.state.resItems.items_ras?h.createElement(h.Fragment,null,h.createElement(Z.ZP,{item:!0,xs:12},h.createElement("h1",null,"Куплено по наклданым"),h.createElement(g.Z,{component:v.Z},h.createElement(p.Z,{"aria-label":"a dense table"},h.createElement(y.Z,null,h.createElement(w.Z,null,h.createElement(f.Z,null,"Наименование товара"),h.createElement(f.Z,null,"Объем товра"),h.createElement(f.Z,null,"Объем заготовки"),h.createElement(f.Z,null,"Сумма"),h.createElement(f.Z,null,"Кол-во наклданых"))),h.createElement(_.Z,null,this.state.resItems.items_ras.map((function(e,t){return h.createElement(w.Z,{key:t},h.createElement(f.Z,null," ",e.name," "),h.createElement(f.Z,null," ",e.count_item+" "+e.ei_name," "),h.createElement(f.Z,null," ",e.count_pf+" "+e.ei_name_pf," "),h.createElement(f.Z,null," ",e.sum," "),h.createElement(f.Z,null," ",e.count_bill," "))})),h.createElement(w.Z,null,h.createElement(f.Z,null," Всего: "),h.createElement(f.Z,null," "),h.createElement(f.Z,null," "),h.createElement(f.Z,null," ",this.state.resItems.full_sum," "),h.createElement(f.Z,null," ")))))),h.createElement(Z.ZP,{item:!0,xs:12},h.createElement("h1",null,"Расход заготовок (включая рецепты)"),h.createElement(g.Z,{component:v.Z},h.createElement(p.Z,{"aria-label":"a dense table"},h.createElement(y.Z,null,h.createElement(w.Z,null,h.createElement(f.Z,null,"Наименование заготовки"),h.createElement(f.Z,null,"Объем заготовок"),h.createElement(f.Z,null,"Кол-во роллов"),h.createElement(f.Z,null,"Сумма роллов (примерно)"))),h.createElement(_.Z,null,this.state.resItems.pf_ras.map((function(e,t){return h.createElement(w.Z,{key:t},h.createElement(f.Z,null," ",e.pf_name," "),h.createElement(f.Z,null," ",e.count_pf+" "+e.ei_name," "),h.createElement(f.Z,null," ",e.count_rolls," "),h.createElement(f.Z,null," ",e.price_rolls," "))})))))),h.createElement(Z.ZP,{item:!0,xs:12},h.createElement("h1",null,"Расход рецептов"),h.createElement(g.Z,{component:v.Z},h.createElement(p.Z,{"aria-label":"a dense table"},h.createElement(y.Z,null,h.createElement(w.Z,null,h.createElement(f.Z,null,"Наименование заготовки"),h.createElement(f.Z,null,"Объем заготовок"),h.createElement(f.Z,null,"Кол-во роллов"))),h.createElement(_.Z,null,this.state.resItems.rec_ras.map((function(e,t){return h.createElement(w.Z,{key:t},h.createElement(f.Z,null," ",e.pf_name," "),h.createElement(f.Z,null," ",e.count_pf+" "+e.ei_name," "),h.createElement(f.Z,null," ",e.count_rolls," "))}))))))):null,this.state.catItems&&this.state.catItems.rec_ras?h.createElement(Z.ZP,{item:!0,xs:12},h.createElement(b.Z,{disabled:!0},h.createElement(I.Z,null,h.createElement(z.Z,{style:{width:"50%"}},"Роллов: ",this.state.catItems.count_pos.count_rolls),h.createElement(z.Z,{style:{width:"50%"}},"Пиццы: ",this.state.catItems.count_pos.count_pizza))),this.state.catItems.rec_ras.map((function(e,t){return h.createElement(b.Z,{key:t},h.createElement(I.Z,{expandIcon:h.createElement(x.Z,null),"aria-controls":"panel1bh-content"},h.createElement(z.Z,{style:{width:"60%"}},e.name),h.createElement(z.Z,{style:{width:"20%"}},e.this_price),h.createElement(z.Z,{style:{width:"20%"}},e.price_by_items)),h.createElement(k.Z,null,e.parent_cat.map((function(e,t){return h.createElement(b.Z,{key:t},h.createElement(I.Z,{expandIcon:h.createElement(x.Z,null),"aria-controls":"panel1bh-content"},h.createElement(z.Z,{style:{width:"60%",paddingLeft:20}},e.name),h.createElement(z.Z,{style:{width:"20%",paddingLeft:20}},e.this_price),h.createElement(z.Z,{style:{width:"20%",paddingLeft:20}},e.price_by_items)),h.createElement(k.Z,null,h.createElement(b.Z,{disabled:!0},h.createElement(I.Z,null,h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},"Товар"),h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},"Товара"),h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},"Заготовок"),h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},"Накладных"),h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},"Сумма"))),e.items.map((function(e,t){return h.createElement(b.Z,{key:t,disabled:!0},h.createElement(I.Z,null,h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},e.name),h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},e.count_item," ",e.ei_name),h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},e.count_pf," ",e.ei_name),h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},e.count_bill),h.createElement(z.Z,{style:{width:"20%",paddingLeft:40}},e.sum)))}))))}))))})),h.createElement(b.Z,{disabled:!0},h.createElement(I.Z,null,h.createElement(z.Z,{style:{width:"60%",marginRight:-15}},"Всего:"),h.createElement(z.Z,{style:{width:"40%"}},this.state.catItems.full_sum)))):null))}}]),$}(h.Component);function M(){return h.createElement(B,null)}},7122:(e,t,n)=>{var a=n(4783)(e.id,{locals:!1});e.hot.dispose(a),e.hot.accept(void 0,a)}}]);
//# sourceMappingURL=307.db30f797fa5822a7be61.js.map