{"version":3,"file":"104.4968b0f2eb5a3ede0d1a.js","mappings":"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","sources":["webpack://package.json/./src/components/promo_items_stat/promo_items_stat.component.jsx","webpack://package.json/./src/components/promo_items_stat/promo_items_stat.style.scss"],"sourcesContent":["import React from 'react';\r\n\r\nimport Grid from '@mui/material/Grid';\r\nimport Button from '@mui/material/Button';\r\n\r\nimport Table from '@mui/material/Table';\r\nimport TableBody from '@mui/material/TableBody';\r\nimport TableCell from '@mui/material/TableCell';\r\nimport TableHead from '@mui/material/TableHead';\r\nimport TableRow from '@mui/material/TableRow';\r\n\r\nimport Backdrop from '@mui/material/Backdrop';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\n\r\nimport { MyDatePickerNew, MyTextInput, MyAutocomplite } from '../../stores/elements';\r\n\r\nconst queryString = require('query-string');\r\n\r\nfunction formatDate(date) {\r\n  var d = new Date(date),\r\n      month = '' + (d.getMonth() + 1),\r\n      day = '' + d.getDate(),\r\n      year = d.getFullYear();\r\n\r\n  if (month.length < 2) \r\n      month = '0' + month;\r\n  if (day.length < 2) \r\n      day = '0' + day;\r\n\r\n  return [year, month, day].join('-');\r\n}\r\n\r\nclass PromoItemsStat_ extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n        \r\n    this.state = {\r\n      module: 'promo_items_stat',\r\n      module_name: '',\r\n      is_load: false,\r\n      \r\n      date_start: formatDate(new Date()),\r\n      date_end: formatDate(new Date()),\r\n      point_list: [],\r\n      choosePoint: [],\r\n\r\n      stats: [],\r\n\r\n      chooseItem: null,\r\n      items_list: [],\r\n      promoName: ''\r\n    };\r\n  }\r\n  \r\n  async componentDidMount(){\r\n    let data = await this.getData('get_all');\r\n    \r\n    this.setState({\r\n      module_name: data.module_info.name,\r\n      point_list: data.points,\r\n      stats: data.stats,\r\n      items_list: data.items\r\n    })\r\n    \r\n    document.title = data.module_info.name;\r\n  }\r\n  \r\n  getData = (method, data = {}) => {\r\n    \r\n    this.setState({\r\n      is_load: true\r\n    })\r\n    \r\n    return fetch('https://jacochef.ru/api/index_new.php', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type':'application/x-www-form-urlencoded'},\r\n      body: queryString.stringify({\r\n        method: method, \r\n        module: this.state.module,\r\n        version: 2,\r\n        login: localStorage.getItem('token'),\r\n        data: JSON.stringify( data )\r\n      })\r\n    }).then(res => res.json()).then(json => {\r\n      \r\n      if( json.st === false && json.type == 'redir' ){\r\n        window.location.pathname = '/';\r\n        return;\r\n      }\r\n      \r\n      if( json.st === false && json.type == 'auth' ){\r\n        window.location.pathname = '/auth';\r\n        return;\r\n      }\r\n      \r\n      setTimeout( () => {\r\n        this.setState({\r\n          is_load: false\r\n        })\r\n      }, 300 )\r\n      \r\n      return json;\r\n    })\r\n    .catch(err => { \r\n      console.log( err )\r\n      this.setState({\r\n        is_load: false\r\n      })\r\n    });\r\n  }\r\n   \r\n  async getStat() {\r\n    let data = {\r\n      choosePoint   : this.state.choosePoint,\r\n      date_start    : this.state.date_start,\r\n      date_end      : this.state.date_end,\r\n      promoName     : this.state.promoName,\r\n      chooseItem    : this.state.chooseItem,\r\n    };\r\n    \r\n    let res = await this.getData('get_all', data);\r\n\r\n    console.log( data )\r\n    console.log( res )\r\n\r\n    this.setState({\r\n      stats: res.stats\r\n    })\r\n  }\r\n\r\n  choosePoint(event, data){\r\n    this.setState({\r\n      choosePoint: data\r\n    })\r\n  }\r\n\r\n  chooseData(data, val, val2){\r\n    this.setState({\r\n      [data]: data != 'promoName' && data != 'chooseItem' ? formatDate(val) : data == 'chooseItem' ? val2 : val\r\n    })\r\n  }\r\n\r\n  chooseDataNew(data, val, val2){\r\n    if( data == 'promoName' ){\r\n      this.setState({\r\n        [data]: val.target.value,\r\n        chooseItem: val.target.value.length > 0 ? null : this.state.chooseItem\r\n      })\r\n    }\r\n\r\n    if( data == 'chooseItem' ){\r\n      this.setState({\r\n        [data]: val2,\r\n        promoName: val2 ? '' : this.state.promoName\r\n      })\r\n    }\r\n  }\r\n\r\n  render(){\r\n    return (\r\n      <>\r\n        <Backdrop open={this.state.is_load} style={{ zIndex: 99 }}>\r\n          <CircularProgress color=\"inherit\" />\r\n        </Backdrop>\r\n        \r\n        <Grid container spacing={3}>\r\n          <Grid item xs={12} sm={12}>\r\n            <h1>{this.state.module_name}</h1>\r\n          </Grid>\r\n          \r\n          <Grid item xs={12} sm={2}>\r\n            <MyAutocomplite data={this.state.point_list} value={this.state.choosePoint} func={ this.choosePoint.bind(this) } multiple={true} label='Точка' />\r\n          </Grid>\r\n\r\n          <Grid item xs={12} sm={2}>\r\n            <MyDatePickerNew label={'Дата от'} value={this.state.date_start} func={ this.chooseData.bind(this, 'date_start') } />\r\n          </Grid>\r\n          <Grid item xs={12} sm={2}>\r\n            <MyDatePickerNew label={'Дата до'} value={this.state.date_end} func={ this.chooseData.bind(this, 'date_end') } />\r\n          </Grid>\r\n\r\n          <Grid item xs={12} sm={3}>\r\n            <MyTextInput value={this.state.promoName} func={ this.chooseDataNew.bind(this, 'promoName') } label='Промокод' />\r\n          </Grid>\r\n          <Grid item xs={12} sm={3}>\r\n            <MyAutocomplite data={this.state.items_list} value={this.state.chooseItem} func={ this.chooseDataNew.bind(this, 'chooseItem') } multiple={false} label='Товар' />\r\n          </Grid>\r\n          \r\n          \r\n          \r\n          <Grid item xs={12} sm={3}>\r\n            <Button variant=\"contained\" onClick={this.getStat.bind(this)}>Обновить</Button>\r\n          </Grid>\r\n          \r\n          <Grid item xs={12} sm={6}>\r\n            \r\n            <Table size={'small'}>\r\n              <TableHead>\r\n                <TableRow>\r\n                  <TableCell>Название</TableCell>\r\n                  <TableCell>Кол-во</TableCell>\r\n                </TableRow>\r\n              </TableHead>\r\n\r\n              <TableBody>\r\n                {!this.state.stats ? null :\r\n                  this.state.stats.map((item, key) =>\r\n                    <TableRow key={key}>\r\n                      <TableCell style={{ textAlign: 'left' }}>{item.name} </TableCell>\r\n                      <TableCell style={{ textAlign: 'left' }}>{item.count} </TableCell>\r\n                    </TableRow>\r\n                  )\r\n                }\r\n              </TableBody>\r\n            \r\n            </Table>\r\n          </Grid>\r\n        </Grid>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport function PromoItemsStat() {\r\n  return (\r\n    <PromoItemsStat_ />\r\n  );\r\n}","// extracted by mini-css-extract-plugin\nexport {};\n    if(module.hot) {\n      // 1663160620464\n      var cssReload = require(\"../../../node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"names":["queryString","require","formatDate","date","d","Date","month","getMonth","day","getDate","year","getFullYear","length","join","PromoItemsStat_","props","method","data","setState","is_load","fetch","headers","body","stringify","module","state","version","login","localStorage","getItem","JSON","then","res","json","st","type","setTimeout","window","location","pathname","err","console","log","module_name","date_start","date_end","point_list","choosePoint","stats","chooseItem","items_list","promoName","this","getData","module_info","name","points","items","document","title","event","val","val2","target","value","Backdrop","open","style","zIndex","CircularProgress","color","Grid","container","spacing","item","xs","sm","func","bind","multiple","label","chooseData","chooseDataNew","Button","variant","onClick","getStat","Table","size","TableHead","TableRow","TableCell","TableBody","map","key","textAlign","count","React","PromoItemsStat","cssReload","id","hot","dispose","accept","undefined"],"sourceRoot":""}