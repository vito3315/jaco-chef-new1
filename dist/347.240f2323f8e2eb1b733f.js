"use strict";(self.webpackChunkpackage_json=self.webpackChunkpackage_json||[]).push([[347],{9347:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P}),n(7993);var l=n(5861),r=n(5671),a=n(3144),o=n(7326),c=n(136),s=n(6215),i=n(1120),u=n(4942),m=n(4687),d=n.n(m),p=n(7294),Z=n(30),E=n(1822),h=n(3150),_=n(6140),f=n(3030),y=n(3406),v=n(8561),g=n(8736),k=n(5722),w=n(3892),x=n(5705),b=n(6406);var I=n(7563),C=function(e){(0,c.Z)(R,e);var t,n,m,C,P=(m=R,C=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,i.Z)(m);if(C){var n=(0,i.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,s.Z)(this,e)});function R(e){var t;return(0,r.Z)(this,R),t=P.call(this,e),(0,u.Z)((0,o.Z)(t),"getData",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.setState({is_load:!0}),fetch("https://jacochef.ru/api/index_new.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:I.stringify({method:e,module:t.state.module,version:2,login:localStorage.getItem("token"),data:JSON.stringify(n)})}).then((function(e){return e.json()})).then((function(e){if(!1!==e.st||"redir"!=e.type){if(!1!==e.st||"auth"!=e.type)return setTimeout((function(){t.setState({is_load:!1})}),300),e;window.location.pathname="/auth"}else window.location.pathname="/auth"})).catch((function(e){console.log(e)}))})),t.state={module:"live_orders",module_name:"",is_load:!1,points:[],point:"0",showReady:!1,read:[],onstol:[],ordersQueue:[]},t}return(0,a.Z)(R,[{key:"componentDidMount",value:(n=(0,l.Z)(d().mark((function e(){var t,n=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("get_all");case 2:t=e.sent,this.setState({points:t.point_list,point:t.point_list[0].id,module_name:t.module_info.name}),document.title=t.module_info.name,setTimeout((function(){n.updateData()}),100);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"changePoint",value:function(e){var t=this,n=e.target.value;this.setState({point:n}),setTimeout((function(){t.updateData()}),50)}},{key:"changeCheckOrders",value:function(e){var t=e.target.checked;this.setState({showReady:t})}},{key:"updateData",value:(t=(0,l.Z)(d().mark((function e(){var t,n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={point_id:this.state.point,showReady:!0===this.state.showReady?1:0},e.next=3,this.getData("get_orders",t);case 3:n=e.sent,this.setState({read:n.read,onstol:n.onstol,ordersQueue:n.prestol_new});case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){return p.createElement(p.Fragment,null,p.createElement(w.Z,{open:this.state.is_load,style:{zIndex:99}},p.createElement(x.Z,{color:"inherit"})),p.createElement(Z.ZP,{container:!0,spacing:3},p.createElement(Z.ZP,{item:!0,xs:12,sm:12},p.createElement("h1",null,this.state.module_name)),p.createElement(Z.ZP,{item:!0,xs:6,sm:6},p.createElement(b.$S,{data:this.state.points,value:this.state.point,func:this.changePoint.bind(this),label:"Точка"})),p.createElement(Z.ZP,{item:!0,xs:6,sm:6},p.createElement(E.Z,{variant:"contained",onClick:this.updateData.bind(this)},"Обновить данные")),p.createElement(Z.ZP,{item:!0,xs:12,sm:12},p.createElement(b.IA,{value:this.state.showReady,func:this.changeCheckOrders.bind(this),label:"Показывать готовые"})),p.createElement(Z.ZP,{item:!0,xs:12,sm:12},p.createElement(y.Z,{component:k.Z},p.createElement(h.Z,{"aria-label":"a dense table"},p.createElement(v.Z,null,p.createElement(g.Z,null,p.createElement(f.Z,null,"#"),p.createElement(f.Z,null,"Тип"),p.createElement(f.Z,null,"Время заказа"),p.createElement(f.Z,null,"Время предзакза"),p.createElement(f.Z,null,"Время выхода на стол"),p.createElement(f.Z,null,"Во сколько собрали"),p.createElement(f.Z,null,"Закрыли"),p.createElement(f.Z,null,"Приготовили"),p.createElement(f.Z,null,"Отдали"),p.createElement(f.Z,null,"Обещали"),p.createElement(f.Z,null,"Статус"),p.createElement(f.Z,null,"Стол"))),p.createElement(_.Z,null,this.state.read.map((function(e,t){return p.createElement(g.Z,{key:t},p.createElement(f.Z,null,e.id),p.createElement(f.Z,null,e.type_order),p.createElement(f.Z,null,1==parseInt(e.preorder)?"":e.date_time_order),p.createElement(f.Z,null,1==parseInt(e.preorder)?e.date_time_preorder_:""),p.createElement(f.Z,null,e.unix_start_stol_or),p.createElement(f.Z,null,e.give_data_time_),p.createElement(f.Z,null,e.close_date_time_order),p.createElement(f.Z,{style:{backgroundColor:1==parseInt(e.type_)?"":e.color}},e.time_),p.createElement(f.Z,{style:{backgroundColor:1!=parseInt(e.type_)?"":e.color}},e.test_time),p.createElement(f.Z,null,0==parseInt(e.preorder)?e.unix_time_to_client:""),p.createElement(f.Z,null,e.status),p.createElement(f.Z,null,e.stol_sborki))})),this.state.onstol.map((function(e,t){return p.createElement(g.Z,{key:t,style:{backgroundColor:"yellow"}},p.createElement(f.Z,null,e.id),p.createElement(f.Z,null,e.type_order),p.createElement(f.Z,null,1==parseInt(e.preorder)?"":e.date_time_order),p.createElement(f.Z,null,1==parseInt(e.preorder)?e.date_time_preorder_:""),p.createElement(f.Z,null,e.unix_start_stol_or),p.createElement(f.Z,null),p.createElement(f.Z,null),p.createElement(f.Z,null),p.createElement(f.Z,null),p.createElement(f.Z,null,0==parseInt(e.preorder)?e.unix_time_to_client:""),p.createElement(f.Z,null,e.status),p.createElement(f.Z,null,e.stol_sborki))}))))),p.createElement(y.Z,{component:k.Z},p.createElement(h.Z,{"aria-label":"a dense table"},p.createElement(v.Z,null,p.createElement(g.Z,null,p.createElement(f.Z,null,"#"),p.createElement(f.Z,null,"Пред"),p.createElement(f.Z,null,"Время оформления"),p.createElement(f.Z,null,"Время выхода на стол"),p.createElement(f.Z,null,"Время закрытия"),p.createElement(f.Z,null,"Обещали"))),p.createElement(_.Z,null,this.state.ordersQueue.map((function(e,t){return p.createElement(g.Z,{key:t},p.createElement(f.Z,null,e.id),p.createElement(f.Z,null,1==parseInt(e.is_preorder)?e.date_time_preorder:""),p.createElement(f.Z,null,0==parseInt(e.is_preorder)?e.date_time_order:""),p.createElement(f.Z,null,e.time_start_order),p.createElement(f.Z,null,e.time_end_order),p.createElement(f.Z,null,0==parseInt(e.is_preorder)?e.unix_time_to_client:""))}))))))))}}]),R}(p.Component);function P(){return p.createElement(C,null)}},7993:(e,t,n)=>{var l=n(4783)(e.id,{locals:!1});e.hot.dispose(l),e.hot.accept(void 0,l)}}]);
//# sourceMappingURL=347.240f2323f8e2eb1b733f.js.map